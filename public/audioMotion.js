/*! For license information please see audioMotion.js.LICENSE.txt */
(()=>{var e,t={6965:(e,t,a)=>{"use strict";var n=a(4015);const o="/music",s=!!window.showDirectoryPicker,r="Click to open a new root folder",i="No music found on server and no browser support for File System API",l="loading";let c,d,u,f,p,h=[],m=/.*/,b=[],g=!1,v=!1,k=!1;function y(e,t){f.innerHTML="",p.innerHTML="",p.style.backgroundImage="";const a=(e,t)=>{const a=document.createElement("li"),n=e.name||e;a.dataset.type=null!==n.match(/\.(m3u|m3u8)$/)&&"file"==t?"list":t,a.dataset.path=n,a.dataset.subs=+!!e.subs,a.innerText=n,a.handle=e.handle,a.dirHandle=e.dirHandle,a.subs=e.subs,p.append(a)},n=e=>p.style.backgroundImage="linear-gradient( #fff9 0%, #fff9 100% )"+(e?`, url('${e}')`:"");if(0==b.length&&(f.innerHTML=i),h.forEach((({dir:e},t)=>{f.innerHTML+=`<li data-depth="${h.length-t-1}">${e}</li> ${"/"==e?"":"/"} `})),b.forEach((e=>{p.innerHTML+=`<li data-type="mount" ${v&&!c?'class="full-panel"':""} data-path="${e}">[ ${e} ]</li>`})),h.length>1&&(p.innerHTML+='<li data-type="dir" data-path="..">[ parent folder ]</li>'),e){const{cover:t,dirs:o,files:s}=e;o&&o.forEach((e=>a(e,"dir"))),s&&s.forEach((e=>a(e,"file"))),t&&t.handle?t.handle.getFile().then((e=>n(URL.createObjectURL(e)))):n(t?L(t.name):"")}p.scrollTop=t||0}async function w(e,t){let a,n=e&&"string"!=typeof e?e:null,o=c,s=[...h];if(n&&(e=n.name),e)if(".."==e){a=h.pop();const e=h[h.length-1];e&&e.handle&&(n=e.handle)}else h.push({dir:e,scrollTop:p.scrollTop,handle:n});p.classList.add(l),c&&n&&(c=n);const r=await E(L(),c);return p.classList.remove(l),!1!==r?(y(r,t||a&&a.scrollTop),u&&u(h),!0):(h=s,c=o,!1)}function x(e){return e.replace(/[#%&]/g,(e=>({"#":"%23","%":"%25","&":"%26"}[e])))}function L(e){let t="";return h.forEach((({dir:e})=>{t+=e+("/"==e?"":"/")})),e&&(t+=e),t=x(t),k&&"/"==t[0]&&(t=t.slice(1)),t}function S(e="li"){let t=[];return p.querySelectorAll(e).forEach((e=>{const{path:a,type:n}=e.dataset,{handle:o,dirHandle:s,subs:r}=e;["file","list"].includes(n)&&t.push({file:L(a),handle:o,dirHandle:s,subs:r,type:n})})),t}async function E(e,t){let a;try{if(s&&t instanceof FileSystemDirectoryHandle){a=[];for await(const[e,n]of t.entries())a.push({name:e,handle:n,dirHandle:t})}else{const t=await fetch(e);a=!!t.ok&&await t.text()}}catch(e){a=!1}return!1!==a&&function(e,t){const a=/\.(jpg|jpeg|webp|avif|png|gif|bmp)$/i,n=/\.vtt$/i;let o=[],r=[],i=[],l=[];const c=(e,t)=>{const n=new RegExp(`${t}.*${a.source}`,"i");return e.find((e=>(e.name||e).match(n)))};if(Array.isArray(e)&&s)for(const t of e){const{name:e,handle:s,dirHandle:c}=t;s instanceof FileSystemDirectoryHandle?o.push(t):s instanceof FileSystemFileHandle&&(e.match(a)?i.push(t):e.match(n)&&l.push(t),e.match(m)&&r.push(t))}else for(const{url:t,file:s}of T(e)){const e={name:s};"/"==t.slice(-1)?s.match(/(parent directory|\.\.)/i)||o.push(e):(s.match(a)?i.push(e):s.match(n)&&l.push(e),s.match(m)&&r.push(e))}for(const e of l){const{name:a,handle:n}=e,[,o,,s]=a.match(/(.*?)(\.([a-z]{0,3}))?\.vtt$/i)||[],i=r.find((e=>e.name.startsWith(o)));i&&(i.subs={src:t?t+a:L(a),lang:s,handle:n})}const d=(e,t)=>(new Intl.Collator).compare(e.name,t.name);return{cover:c(i,"cover")||c(i,"folder")||c(i,"front")||i[0],dirs:o.sort(d),files:r.sort(d)}}(a,e)}async function C(e){const t=[...h],a=e.split("/");let n=t[t.length-1].handle;for(;a.length>1;){const e=a.shift();if(".."==e)t.pop(),n=t[t.length-1].handle;else{try{n=await n.getDirectoryHandle(e)}catch(e){return{}}t.push({handle:n})}}const o=a.shift(),s=n;try{n=await n.getFileHandle(o)}catch(e){n=void 0}return{handle:n,dirHandle:s}}function T(e){const t=e.match(/href="[^"]*"[^>]*>[^<]*<\/a>/gi);let a=[];for(const e of t){const t=e.match(/href="([^"]*)"[^>]*>\s*([^<]*)<\/a>/i)[1],n="/"==t.slice(-1),o=t.slice(t.lastIndexOf("/",n?t.length-2:void 0)+1),s=decodeURIComponent(o.slice(0,n?-1:void 0));a.push({url:o,file:s})}return a}async function $(e){const t=e&&e[e.length-1],a=c,n=[...h];h=e,t&&t.handle&&(c=t.handle);const o=!!e&&await w();return o||(c=a,h=n,v||h.length?v&&!c&&y():w(b[0])),o}var A=a(6015),_=(a(6216),a(7783)),O=a(246),I=a(4596),M=a.n(I);O.Ay.mount(new O.cR);const P=location.origin+location.pathname,R="25.7-beta.2",D="backgrounds",H=4,F=2e3,B=-1,q="0",N="1",j="2",U="3",z="4",G="0",W="1",K="2",Y="0",J="1",X="2",V="3",Z="6",Q="7",ee="8",te={album:"",artist:"",codec:"",cover:"",duration:"",file:"",quality:"",title:""},ae="dual-combined",ne="single",oe="gradient",se="bar-index",re="bar-level",ie=20,le=["mp3","flac","m4a","aac","ogg","wav"],ce=["jpg","jpeg","webp","avif","png","gif","bmp"],de=["m3u","m3u8"],ue=["mkv","mpg","webm","mp4","avi","mov"],fe="local",pe="bgDir",he="custom-grads",me="custom-preset",be="disabled-bgfit",ge="disabled-gradients",ve="disabled-properties",ke="display-options",ye="force-filesystem",we="general-settings",xe="last-config",Le="last-dir",Se="last-version",Ee="peak-settings",Ce="playlists",Te="playqueue",$e="sensitivity-presets",Ae="subtitles-settings",_e="pl_",Oe="11",Ie="0",Me="10",Pe="101",Re="close",De="open",He=0,Fe=2,Be="default",qe="last",Ne="No description",je="0",Ue="1",ze="2",Ge="3",We="alpha",Ke="nobg",Ye="bands",Je="imgfit",Xe="colormode",Ve="gradient",Ze="leds",Qe="lumi",et="mode",tt="outline",at="peaks",nt="presets",ot="radial",st="reflex",rt="round",it="split",lt="bark",ct="log",dt=0,ut=2,ft="config.json",pt={defaultAccessMode:fe,enableLocalAccess:!0,mediaPanel:De},ht="shadow",mt="white",bt="subs-bg-",gt="subs-color-",vt="bottom",kt="center",yt="show",wt="D",xt=812,Lt=document.querySelector.bind(document),St=document.querySelectorAll.bind(document),Et=Lt("#alpha_bars"),Ct=Lt("#analyzer"),Tt=Lt("#ansi_bands"),$t=Lt("#auto_hide"),At=Lt("#background"),_t=Lt("#band_count"),Ot=Lt("#bar_space"),It=Lt("#bg_img_dim"),Mt=Lt("#bg_img_fit"),Pt=Lt("#bg_location"),Rt=Lt("#bg_max_items"),Dt=Lt("#channel_layout"),Ht=Lt("#color_mode"),Ft=Lt("#bg_container"),Bt=Lt("#bg_dim"),qt=Lt("#end_timeout"),Nt=Lt("#fft_size"),jt=Lt("#fill_alpha"),Ut=Lt("#fps"),zt=Lt("#freq_scale"),Gt=Lt("#fs_height"),Wt=Lt("#gradient"),Kt=Lt("#gradientRight"),Yt=Lt("#gravity"),Jt=Lt("#info_timeout"),Xt=Lt("#led_display"),Vt=Lt("#linear_amplitude"),Zt=Lt("#line_width"),Qt=Lt("#link_grads"),ea=Lt("#lo_res"),ta=Lt("#lumi_bars"),aa=Lt("#max_fps"),na=Lt("#files_panel"),oa=Lt("#mirror"),sa=Lt("#mode"),ra=Lt("#mute"),ia=Lt("#no_dim_subs"),la=Lt("#no_dim_video"),ca=Lt("#no_shadow"),da=Lt("#outline"),ua=Lt("#osd"),fa=Lt("#osd_font_size"),pa=Lt("#panel_selection"),ha=Lt("#peak_fade"),ma=Lt("#peak_hold"),ba=Lt("#pip_ratio"),ga=Lt("#playlists"),va=Lt("#presets"),ka=Lt("#radial"),ya=Lt("#radius"),wa=Lt("#random_mode"),xa=Lt("#freq_max"),La=Lt("#freq_min"),Sa=Lt("#reflex"),Ea=Lt("#repeat"),Ca=Lt("#round_bars"),Ta=Lt("#save_dir"),$a=Lt("#save_queue"),Aa=Lt("#scaleX"),_a=Lt("#scaleY"),Oa=Lt("#sensitivity"),Ia=Lt("#show_count"),Ma=Lt("#show_cover"),Pa=Lt("#show_peaks"),Ra=Lt("#show_song"),Da=Lt("#show_subs"),Ha=Lt("#smoothing"),Fa=Lt("#song_duration"),Ba=Lt("#current_time"),qa=Lt("#progress"),Na=Lt("#source"),ja=Lt("#spin"),Ua=Lt("#split_grad"),za=Lt("#subs_background"),Ga=Lt("#subs_color"),Wa=Lt("#subs_position"),Ka=Lt("#enable_surround"),Ya=Lt("#toggle_panel"),Ja=Lt("#track_timeout"),Xa=Lt("#video"),Va=Lt("#volume"),Za=Lt("#warp"),Qa=Lt("#weighting"),en=[{key:"demo",name:"Demo (random)",options:{randomMode:6}},{key:"bands",name:"Octave Bands",options:{alphaBars:0,ansiBands:0,background:j,barSpace:.25,bgImageDim:.3,bgImageFit:Y,channelLayout:ne,colorMode:oe,freqMax:2e4,freqMin:25,freqScale:ct,gradient:"rainbow",ledDisplay:0,linearAmpl:1,lumiBars:0,mirror:0,mode:"2",outlineBars:0,radial:0,randomMode:0,reflex:Ue,roundBars:0,showPeaks:1,showScaleX:ut,showScaleY:dt,showSong:1,splitGrad:0,weighting:wt}},{key:"ledbars",name:"Classic LED bars",options:{alphaBars:0,ansiBands:1,background:j,barSpace:.25,bgImageDim:.3,bgImageFit:J,channelLayout:ne,colorMode:oe,freqMax:2e4,freqMin:25,freqScale:ct,gradient:"classic",ledDisplay:1,linearAmpl:1,lumiBars:0,outlineBars:0,mirror:0,mode:"6",radial:0,randomMode:0,reflex:je,roundBars:0,showPeaks:1,showScaleX:1,showScaleY:dt,showSong:1,splitGrad:0,weighting:wt}},{key:"dual",name:"Dual-channel combined Graph, Bark frequency scale",options:{ansiBands:0,background:j,bgImageDim:.3,bgImageFit:J,channelLayout:ae,colorMode:oe,fillAlpha:.3,freqMax:2e4,freqMin:20,freqScale:lt,gradient:"cool",gradientRight:"dusk",linearAmpl:1,lineWidth:1.5,linkGrads:0,mirror:0,mode:Pe,radial:0,randomMode:0,reflex:je,showPeaks:He,showScaleX:dt,showScaleY:dt,showSong:1,splitGrad:0,weighting:wt}},{key:"radial",name:"Radial Color by Level",options:{alphaBars:1,ansiBands:0,background:j,barSpace:.1,bgImageDim:.3,bgImageFit:V,channelLayout:ne,colorMode:re,freqMax:2e4,freqMin:20,freqScale:ct,gradient:"prism",ledDisplay:0,linearAmpl:1,lumiBars:0,mirror:0,mode:"5",outlineBars:0,radial:1,radius:.35,randomMode:0,showPeaks:1,showScaleX:1,showScaleY:dt,showSong:1,spin:1,splitGrad:0,weighting:wt}},{key:"round",name:"Round Bars reflex",options:{alphaBars:0,background:j,barSpace:.25,bgImageDim:.3,bgImageFit:Q,channelLayout:ne,colorMode:se,freqMax:2e4,freqMin:20,freqScale:ct,gradient:"apple",ledDisplay:0,linearAmpl:1,lumiBars:0,mirror:0,mode:"3",outlineBars:0,radial:0,randomMode:0,reflex:ze,roundBars:1,showPeaks:He,showScaleX:dt,showScaleY:dt,showSong:1,splitGrad:0,weighting:wt}},{key:qe,name:"Last session",options:{}},{key:Be,name:"Restore defaults",options:{alphaBars:0,ansiBands:0,background:q,bandCount:"6",barSpace:.1,bgImageDim:.5,bgImageFit:J,channelLayout:ne,colorMode:oe,fftSize:8192,fillAlpha:.1,freqMax:2e4,freqMin:20,freqScale:ct,gradient:"prism",gradientRight:"prism",ledDisplay:0,linearAmpl:0,lineWidth:2,linkGrads:0,loRes:0,lumiBars:0,micSource:0,mirror:0,mode:Ie,mute:0,noShadow:1,outlineBars:0,radial:0,radius:.35,randomMode:0,reflex:je,repeat:0,roundBars:0,sensitivity:1,showFPS:0,showPeaks:1,showScaleX:1,showScaleY:dt,showSong:1,showSubtitles:1,smoothing:.7,spin:2,splitGrad:0,volume:1,weighting:""}}],tn={apple:{name:"Apple ][",colorStops:[{pos:.1667,color:"#61bb46"},{pos:.3333,color:"#fdb827"},{pos:.5,color:"#f5821f"},{pos:.6667,color:"#e03a3e"},{pos:.8333,color:"#963d97"},{pos:1,color:"#009ddc"}],disabled:!1},aurora:{name:"Aurora",bgColor:"#0e172a",colorStops:[{pos:.1,color:"hsl( 120, 100%, 50% )"},{pos:1,color:"hsl( 216, 100%, 50% )"}],disabled:!1},borealis:{name:"Borealis",bgColor:"#0d1526",colorStops:[{pos:.1,color:"hsl( 120, 100%, 50% )"},{pos:.5,color:"hsl( 189, 100%, 40% )"},{pos:1,color:"hsl( 290, 60%, 40% )"}],disabled:!1},candy:{name:"Candy",bgColor:"#0d0619",colorStops:[{pos:.1,color:"#ffaf7b"},{pos:.5,color:"#d76d77"},{pos:1,color:"#3a1c71"}],disabled:!1},classic:{name:"Classic",colorStops:["#f00",{color:"#ff0",level:.85,pos:.6},{color:"#0f0",level:.475}],disabled:!1},cool:{name:"Cool",bgColor:"#0b202b",colorStops:["hsl( 208, 0%, 100% )","hsl( 208, 100%, 35% )"],disabled:!1},dusk:{name:"Dusk",bgColor:"#0e172a",colorStops:[{pos:.2,color:"hsl( 55, 100%, 50% )"},{pos:1,color:"hsl( 16, 100%, 50% )"}],disabled:!1},miami:{name:"Miami",bgColor:"#110a11",colorStops:[{pos:.024,color:"rgb( 251, 198, 6 )"},{pos:.283,color:"rgb( 224, 82, 95 )"},{pos:.462,color:"rgb( 194, 78, 154 )"},{pos:.794,color:"rgb( 32, 173, 190 )"},{pos:1,color:"rgb( 22, 158, 95 )"}],disabled:!1},orient:{name:"Orient",bgColor:"#100",colorStops:[{pos:.1,color:"#f00"},{pos:1,color:"#600"}],disabled:!1},outrun:{name:"Outrun",bgColor:"#101",colorStops:[{pos:0,color:"rgb( 255, 223, 67 )"},{pos:.182,color:"rgb( 250, 84, 118 )"},{pos:.364,color:"rgb( 198, 59, 243 )"},{pos:.525,color:"rgb( 133, 80, 255 )"},{pos:.688,color:"rgb( 74, 104, 247 )"},{pos:1,color:"rgb( 35, 210, 255 )"}],disabled:!1},pacific:{name:"Pacific Dream",bgColor:"#051319",colorStops:[{pos:.1,color:"#34e89e"},{pos:1,color:"#0f3443"}],disabled:!1},prism:{name:"Prism",colorStops:["#a35","#c66","#e94","#ed0","#9d5","#4d8","#2cb","#0bc","#09c","#36b"],disabled:!1},prism_old:{name:"Prism (legacy)",colorStops:["hsl( 0, 100%, 50% )","hsl( 60, 100%, 50% )","hsl( 120, 100%, 50% )","hsl( 180, 100%, 50% )","hsl( 240, 100%, 50% )"],disabled:!0},rainbow:{name:"Rainbow",dir:"h",colorStops:["#817","#a35","#c66","#e94","#ed0","#9d5","#4d8","#2cb","#0bc","#09c","#36b","#639"],disabled:!1},rainbow_old:{name:"Rainbow (legacy)",dir:"h",colorStops:["hsl( 0, 100%, 50% )","hsl( 60, 100%, 50% )","hsl( 120, 100%, 50% )","hsl( 180, 100%, 47% )","hsl( 240, 100%, 58% )","hsl( 300, 100%, 50% )","hsl( 360, 100%, 50% )"],disabled:!0},shahabi:{name:"Shahabi",bgColor:"#060613",colorStops:[{pos:.1,color:"#66ff00"},{pos:1,color:"#a80077"}],disabled:!1},summer:{name:"Summer",bgColor:"#041919",colorStops:[{pos:.1,color:"#fdbb2d"},{pos:1,color:"#22c1c3"}],disabled:!1},sunset:{name:"Sunset",bgColor:"#021119",colorStops:[{pos:.1,color:"#f56217"},{pos:1,color:"#0b486b"}],disabled:!1},tiedye:{name:"Tie Dye",colorStops:[{pos:.038,color:"rgb( 15, 209, 165 )"},{pos:.208,color:"rgb( 15, 157, 209 )"},{pos:.519,color:"rgb( 133, 13, 230 )"},{pos:.731,color:"rgb( 230, 13, 202 )"},{pos:.941,color:"rgb( 242, 180, 107 )"}],disabled:!1}},an=[[Oe,"Bars"],[Ie,"FFT"],[Me,"Graph"]],nn=[[ne,"Single"],[ae,"Comb"],["dual-horizontal","Horiz"],["dual-vertical","Vert"]],on=[{value:nt,text:"User Presets",disabled:!0},{value:We,text:"Alpha",disabled:!1},{value:et,text:"Analyzer Mode",disabled:!1},{value:Ke,text:"Background",disabled:!1},{value:Je,text:"BG Image Fit",disabled:!1},{value:Ye,text:"Band Count",disabled:!1},{value:Xe,text:"Color Mode",disabled:!1},{value:Ve,text:"Gradients",disabled:!1},{value:Ze,text:"LEDs",disabled:!1},{value:Qe,text:"Lumi",disabled:!1},{value:tt,text:"Outline",disabled:!1},{value:at,text:"Peaks",disabled:!1},{value:ot,text:"Radial",disabled:!1},{value:st,text:"Reflex",disabled:!1},{value:rt,text:"Round",disabled:!1},{value:it,text:"Split",disabled:!1}],sn=[{min:-70,max:-20,boost:1},{min:-85,max:-25,boost:1.6},{min:-100,max:-30,boost:2.4}],rn={info:5,track:10,end:10,covers:!0,count:!0},ln=[{value:Y,text:"Adjust",disabled:!1},{value:J,text:"Center",disabled:!1},{value:V,text:"Pulse",disabled:!1},{value:X,text:"Repeat",disabled:!1},{value:Z,text:"Warp",disabled:!1},{value:Q,text:"Warp Drive",disabled:!1},{value:ee,text:"Wormhole",disabled:!1},{value:"4",text:"Zoom In",disabled:!1},{value:"5",text:"Zoom Out",disabled:!1}],cn=[$t,Pt,Rt,Gt,aa,ia,la,fa,ba,Ta,$a,Ka],dn={autoHide:!1,bgLocation:W,bgMaxItems:100,osdFontSize:"1",fsHeight:100,maxFPS:60,noDimVideo:!0,noDimSubs:!0,pipRatio:2.35,saveDir:!0,saveQueue:!0,surround:!1},un=[[30,"30"],[60,"60"],[0,"unlimited"]],fn=[[1,"1:1"],[1.33,"4:3"],[1.78,"16:9"],[2.35,"2.35:1"],[3.55,"32:9"]],pn=[Yt,ha,ma],hn={gravity:3.8,peakFade:750,peakHold:500},mn=[za,Ga,Wa],bn={background:ht,color:mt,position:"top"},gn=[{value:"files_panel",text:"Media"},{value:"settings",text:"Settings"},{value:"advanced",text:"Advanced"},{value:"console",text:"Console"}];let vn,kn,yn,wn,xn,Ln,Sn,En,Cn,Tn,$n,An,_n,On,In,Mn,Pn,Rn,Dn,Hn,Fn,Bn,qn,Nn,jn,Un,zn,Gn,Wn=[],Kn=[],Yn=[],Jn={},Xn=null,Vn={},Zn=!1,Qn=!1,eo=!1,to=0;const ao=ua.getContext("2d"),no=new Image,oo=document.createElement("video"),so=e=>"data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(e,null,2)),ro=e=>Math.round(100*e)/100,io=(e,t="")=>(e+"").normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().replace(/[^a-z0-9]/g,t),lo=e=>{if(!e)return;let t=0;for(;e=e.previousElementSibling;)t++;return t},co=e=>{let t="";if(vo(e)){const a=e.querySelector(":checked ~ label");a&&(t=a.textContent)}else t=e[e.selectedIndex].text;return t},uo=e=>{let t=e.value;return e==_t&&(t=9-t),vo(e)&&(t=e.elements[e.dataset.prop].value),void 0!==e.dataset.active&&(t=e.dataset.active),""+t},fo=e=>({alphaBars:uo(Et),ansiBands:uo(Tt),background:uo(At),bandCount:uo(_t),barSpace:uo(Ot),bgImageDim:uo(It),bgImageFit:uo(Mt),channelLayout:uo(Dt),colorMode:uo(Ht),fftSize:uo(Nt),fillAlpha:uo(jt),freqMax:uo(xa),freqMin:uo(La),freqScale:uo(zt),gradient:uo(Wt),gradientRight:uo(Kt),ledDisplay:uo(Xt),linearAmpl:uo(Vt),lineWidth:uo(Zt),linkGrads:uo(Qt),loRes:uo(ea),lumiBars:uo(ta),mirror:uo(oa),mode:uo(sa),noShadow:uo(ca),outlineBars:uo(da),radial:uo(ka),radius:uo(ya),randomMode:uo(wa),reflex:uo(Sa),repeat:uo(Ea),roundBars:uo(Ca),sensitivity:uo(Oa),showFPS:uo(Ut),showPeaks:uo(Pa),showScaleX:uo(Aa),showScaleY:uo(_a),showSong:uo(Ra),showSubtitles:uo(Da),smoothing:uo(Ha),spin:uo(ja),splitGrad:uo(Ua),weighting:uo(Qa)}),po=e=>{const t=+e==e?e:en.findIndex((t=>t.key==e));return t<0||t>en.length-1?-1:t},ho=e=>{const t=po(e);return-1==t?{}:en[t].options},mo=e=>{const t=po(e);return-1!=t&&en[t].name},bo=()=>{const e=uo(Dt)!=ne&&!Lo(Qt);return`Gradient${e?"s":""}: ${tn[Wt.value].name+(e?" / "+tn[Kt.value].name:"")}`},go=e=>e&&e.startsWith("blob:"),vo=e=>"FORM"==e.tagName&&null!=e.dataset.prop,ko=e=>e.startsWith("http")&&!e.startsWith(P),yo=e=>!e||"object"!=typeof e||!Object.keys(e).length,wo=e=>Ft.classList.contains("pip"),xo=(e=Wn[kn])=>e&&e.currentTime>0&&!e.paused&&!e.ended,Lo=e=>!!+uo(e),So=()=>ue.includes(To(Wn[kn].dataset.file).extension),Eo=e=>"string"==typeof e?e.replace(/\\/g,"/"):e,Co=e=>Lo(e)?"ON":"OFF",To=e=>{if("string"!=typeof e)return{};const t=Eo(e),a=t.lastIndexOf("/")+1,n=t.slice(0,a),o=t.slice(a),s=o.lastIndexOf("."),r=s>=0?o.slice(0,s):o,i=s>=0?o.slice(s+1).toLowerCase():"";return{path:n,fileName:o,baseName:r,extension:i}},$o=e=>{const t=/\s*\([0-9]{4}\)/;let a=(e=e.replace(/_/g," ")).match(t);a&&(a=a[0].trim(),e=e.replace(t,"").trim());const[,,n,o,,s,r]=e.match(/(^(-?\d+)([,\.\-\s]))?((.*?)\s+-\s+)?(.*)/);return{album:a,artist:s,title:r,duration:","==o?Io(n):""}},Ao=e=>Sn.children.length,_o=(e=2)=>Math.random()*e|0,Oo=e=>{An?(0,_.hZ)(Le,e):In&&Cs(Le,e)},Io=(e,t)=>{if(Math.abs(e)==1/0||"-1"===e)return"LIVE";let a="",n="",o="";return e<0&&(e=-e,n="-"),(e>=3600||t)&&(o=(e/3600|0)+":",e%=3600,a="0"),o+=(a+(e/60|0)).slice(-2)+":"+("0"+(e%60|0)).slice(-2),n+o},Mo=(e,t)=>{if(e==ra)Zs(t);else if(e==Na)Hs(t);else if(e==Va)Ns(t);else if(e==_t)e.value=9-t;else if(vo(e)){const a=e.querySelector(`[value="${t}"]`);a&&(a.checked=!0)}else e.classList.contains("switch")?e.dataset.active=+t:(e.value=t,-1==e.selectedIndex&&(e.selectedIndex=0));er(e)},Po=(e,t,a,n=1)=>{e.min=t,e.max=a,e.step=n},Ro=(e,t)=>{void 0===t&&(t=!!e.style.display),e.style.display=t?"":"none"},Do=async e=>new Promise(((t,a)=>{e.onerror=()=>{e.onerror=e.onloadeddata=null,a()},e.onloadeddata=()=>{e.onerror=e.onloadeddata=null,t()}}));function Ho(e,t=!1){const a=e.map((e=>qo(e,t)));Promise.all(a).then((e=>{const t=e.reduce(((e,t)=>e+t),0),a=`${t} song${t>1?"s":""} added to the queue${Ao()<F?"":". Queue is full!"}`;M().alert({text:a,time:5}),Ws(!0)}))}function Fo(e,t){const a=t.dataset,n=e.dataset,{album:o,artist:s,picture:r,title:i,year:l}=e.common||{},{bitrate:c,bitsPerSample:d,codec:u,codecProfile:f,container:p,duration:h,lossless:m,numberOfChannels:b,sampleRate:g}=e.format||{};if(n)Object.assign(a,n);else{a.artist=s||a.artist,a.title=i||a.title,a.album=o?o+(l?" ("+l+")":""):a.album,a.codec=u||p?(u||p)+" ("+b+"ch)":a.codec;const e=g?Math.round(g/1e3)+"kHz":"";if(a.quality=m||!c?(d?d+"bits":"")+(e&&d?" / ":"")+e:Math.round(c/1e3)+"kbps"+(f?" "+f:"")+(e?" / ":"")+e,a.duration=h?Io(h):"",r&&r.length){const e=new Blob([r[0].data],{type:r[0].format});a.cover=URL.createObjectURL(e)}}t==Wn[kn]&&Os()}function Bo(e,t){return new Promise((a=>{if(Ao()>=F)return void a(0);const{fileName:n,baseName:o,extension:s}=To(function(e){return e.replace(/%2[356]/g,(e=>({"%23":"#","%25":"%","%26":"&"}[e])))}(e.file)),r=Eo(e.file),i=document.createElement("li"),l=i.dataset;Object.assign(l,te),t||(t=$o(o)),l.album=t.album||"",l.artist=t.artist||"",l.title=t.title||n||r.slice(r.lastIndexOf("//")+2),l.duration=t.duration||"",l.codec=t.codec||s.toUpperCase(),l.file=r,i.handle=e.handle,i.dirHandle=e.dirHandle,i.subs=e.subs,Sn.appendChild(i),!le.includes(s)&&s||(l.retrieve=1,xs()),1!=Ao()||xo()?(En>Ao()-3&&ss(B),a(1)):ss(0).then((()=>a(1)))}))}function qo(e,t=!1){let a;return a=de.includes(To(e.file).extension)?as(e):Bo(e),a.then((e=>{t&&!xo()&&e>0&&us(Ao()-e)})),a}function No(e){const t=+Gt.value;(1==e&&t<+Gt.max||-1==e&&t>+Gt.min)&&(Gt.value=t+Gt.step*e,Ds(Gt)),_s(`Analyzer height: ${Gt.value}%`)}function jo(e){let t=ro((+Va.dataset.value||0)+.05*e);t<0?t=0:t>1&&(t=1),Ns(t),_s("Volume: "+20*t),Qs()}function Uo(e=kn){const t=e instanceof HTMLMediaElement?e:Wn[e],a=t.dataset;Qo(t,null),rs(t),Object.assign(a,te),t.load(),e==kn&&Os()}function zo(e=vn){const t=e.pixelRatio,a=ua.height=Ft.clientHeight*t,n=ua.width=Ft.clientWidth*t;Mn=Math.max(12,Math.min(n,a)/[24,17,13.5][+fa.value]),Pn=3*Mn,Rn=n/2,Dn=n-Mn,Hn=1.4*Mn,Fn=1.8*Hn,jn=n/3-Mn,Bn=a-4*Mn,qn=a-2.8*Mn,Nn=a-1.6*Mn,Un=n-8*Mn,zn=`bold ${.7*Mn}px sans-serif`,Gn=`bold ${Mn}px sans-serif`}function Go(e,t,a){const n=Lt("#console-content"),o=new Date,s=o.toLocaleTimeString([],{hour12:!1})+"."+String(o.getMilliseconds()).padStart(3,"0");a&&(n.innerHTML=""),t&&yn&&yn.classList.add("warning"),e&&(n.innerHTML+=`<div ${t?'class="error"':""}>${s} &gt; ${e}</div>`),n.scrollTop=n.scrollHeight}function Wo(e,t){const a=vo(e)?e.elements[e.dataset.prop]:e.options;let n=(vo(e)?Array.from(a).findIndex((e=>e.checked)):e.selectedIndex)+(t?-1:1);n<0?n=a.length-1:n>=a.length&&(n=0),vo(e)?a[n].checked=!0:e.selectedIndex=n,Ds(e)}function Ko(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function Yo(e,t){if(yo(_n[e]))return;const a=`User Preset #${e+1}`,n=_n[e].name?"<br>"+_n[e].name:"";t?(_n[e]={},Cs(me,_n),M().alert({text:`Deleted ${a}`}),bs()):M().confirm({text:`Do you really want to DELETE ${a}?${n}<br>THIS CANNOT BE UNDONE!`,submitText:"DELETE",submitCallback:()=>{Yo(e,!0)},cancelCallback:()=>{M().alert({text:"Canceled!"})}})}function Jo(e=1){const t=Wn[kn];if(t.duration>0&&t.duration<1/0){let a=t.currentTime+5*e;a<0?a=0:a>t.duration-1&&(a=t.duration-1),_s(1),t.currentTime=a}"m"==Zn&&$s("m",e)}function Xo(){return clearTimeout(wn),!!Zn&&(Zn=!1,!0)}async function Vo(){wo()&&await document.exitPictureInPicture(),vn.toggleFullscreen(),document.activeElement.blur()}function Zo(e){if(e.altKey||e.ctrlKey||e.metaKey)return;const t=e.shiftKey;if("F1"==e.code&&!t)return location.href="#help",void e.preventDefault();if("BODY"==e.target.tagName){if("keydown"==e.type)switch(e.code){case"ArrowUp":t?No(1):jo(1);break;case"ArrowDown":t?No(-1):jo(-1);break;case"ArrowLeft":Zn?(_s("Rewind",1),Jo(-1)):$s("k",-1);break;case"ArrowRight":Zn?(_s("Fast forward",1),Jo()):$s("k");break;default:return}else if(e.code.match(/^(Digit|Numpad)[0-9]$/)){const a=e.code.slice(-1)-1;if(-1==a)t||(vs(!0),Ds(wa,!1));else if(t){const e=fo();e.randomMode=0,Ts(a,e)}else ns(a)}else switch(e.code){case"Delete":case"Backspace":Sn.querySelectorAll(".selected").forEach((e=>{Ls(e),e.remove()}));const e=lo(Sn.querySelector(".current"));void 0!==e?En=e:En>Ao()-1?En=Ao()-1:En--,Ao()?ss(B):(Uo(Ln),xo()||Uo()),Ws(!0);break;case"Space":_s(xo()?"Pause":"Play",1),cs();break;case"ArrowLeft":case"KeyJ":Xo()||t||(_s("Previous track",1),zs(!0));break;case"KeyG":Wo(Wt,t),_s(bo());break;case"ArrowRight":case"KeyK":Xo()||t||(_s("Next track",1),zs());break;case"KeyA":Wo(wa,t),_s("Randomize: "+co(wa)),Ds(wa);break;case"KeyB":Wo(t?Mt:At);const a=At.value[0];_s("Background: "+co(At)+(a>1&&a<7?` (${co(Mt)})`:""));break;case"KeyC":ka.click(),_s("Radial "+Co(ka));break;case"KeyD":Js();break;case"KeyE":Ao()>0&&(Us(),_s("Shuffle"));break;case"KeyF":Vo();break;case"KeyH":Ut.click();break;case"KeyI":Ra.click(),_s("Song info display "+Co(Ra));break;case"KeyL":Xt.click(),_s("LED effect "+Co(Xt));break;case"KeyM":case"KeyV":Wo(sa,t),_s("Mode: "+co(sa));break;case"KeyN":Wo(Oa,t),_s(co(Oa).toUpperCase()+" sensitivity");break;case"KeyO":ea.click(),_s((Lo(ea)?"LOW":"HIGH")+" Resolution");break;case"KeyP":Wo(Pa,t),_s("Peaks "+co(Pa));break;case"KeyR":Ea.click(),_s("Queue repeat "+Co(Ea));break;case"KeyS":const n=["None","Frequencies","Musical Notes",,"Level"],o=function(e){e=-2*e+1;let t=+uo(Aa)+(+uo(_a)<<2)+e;return t<0?t=6:3==t?t+=e:t>6&&(t=0),Mo(Aa,3&t),Mo(_a,t>>2),Ds([Aa,_a]),t}(t);_s("Scale labels: "+(o<5?n[o]:n[o-4]+" + "+n[4]));break;case"KeyT":ca.click(),_s((Lo(ca)?"Flat":"Shadowed")+" text mode");break;case"KeyU":ta.click(),_s("Luminance bars "+Co(ta));break;case"KeyX":Wo(Sa,t),_s("Reflex: "+co(Sa));break;default:return}e.preventDefault()}}function Qo(e,t){const a=e.src||"";go(a)&&URL.revokeObjectURL(a),t?e.src=t:e.removeAttribute("src"),Ps()}async function es(e,t,a){const n=URL.createObjectURL(e);Qo(t,n);try{await Do(t),a&&t.play()}catch(e){}return n}function ts(e){return JSON.parse(localStorage.getItem(e))}function as(e){let t=Eo(e.file);return new Promise((async a=>{let n=[];const o=e=>{Promise.all(n).then((t=>{const n=t.reduce(((e,t)=>e+t),0);a(n),e&&Ws(!0)}))},s=async e=>{let a,s;t=To(t).path;for(let o of e.split(/[\r\n]+/))if("#"!=o.charAt(0)&&""!=o.trim()){let e,r;if(o=Eo(o),s||(s=To(o).baseName),!ko(o)){if(An&&(({handle:e,dirHandle:r}=await C(o)),!e)){Go(`Cannot resolve file handle for ${o}`,!0),s="";continue}o=x(o),":"!=o[1]&&"/"!=o[0]&&(o=t+o)}n.push(Bo({file:o,handle:e,dirHandle:r},{...$o(s),...a?{album:a}:{}})),s=""}else o.startsWith("#EXTINF")?s=o.slice(8):o.startsWith("#EXTALB")&&(a=o.slice(8));o()};if(t)if("string"==typeof t&&de.includes(To(t).extension))e.handle?e.handle.getFile().then((e=>e.text())).then(s).catch((e=>{Go(e,!0),a(0)})):fetch(t).then((e=>e.ok?e.text():(Go(`Fetch returned error code ${e.status} for URI ${t}`,!0),""))).then(s).catch((e=>{Go(e,!0),a(0)}));else{const e=await(0,_.Jt)(!0===t?Te:_e+t);Array.isArray(e)?(e.forEach((e=>{const{file:t,handle:a,dirHandle:o,subs:s,content:r}=e;n.push(Bo({file:t,handle:a,dirHandle:o,...a&&!o?{subs:s}:{}},r))})),o(e!=Te)):(!0!==t&&Go(`Unrecognized playlist file: ${t}`,!0),a(0))}else a(-1)}))}function ns(e,t=!0,a,n){const o=+e==e,s="object"==typeof e,r=s?e:o?_n[e].options:ho(e),i=ho(Be);yo(r)||(t&&!s&&Go("Loading "+(o?"User Preset #"+(+e+1):"'"+mo(e)+"' preset")),e==Be&&delete r.volume,void 0!==r.stereo&&(r.channelLayout=nn[+r.stereo][0]),1.5==r.barSpace&&(r.barSpace=1),+r.fadePeaks&&+r.showPeaks&&(r.showPeaks=Fe),r.mode==Pe&&(r.mode=Me),[Ie,Oe,Me].includes(r.mode)||(r.bandCount=r.mode,r.mode=Oe),+r.noteLabels&&+r.showScaleX&&(r.showScaleX=ut),St("[data-prop]").forEach((e=>{const t=e.dataset.prop,o=void 0!==r[t]?r[t]:a?i[t]:void 0;void 0===o||e==wa&&n||Mo(e,o)})),vn.setOptions({alphaBars:Lo(Et),ansiBands:+uo(Tt),colorMode:uo(Ht),fftSize:uo(Nt),fillAlpha:uo(jt),frequencyScale:uo(zt),ledBars:Lo(Xt),linearAmplitude:+uo(Vt),lineWidth:uo(Zt),loRes:Lo(ea),lumiBars:Lo(ta),maxFPS:uo(aa),maxFreq:uo(xa),minFreq:uo(La),mirror:uo(oa),outlineBars:Lo(da),peakFadeTime:uo(ha),peakHoldTime:uo(ma),radial:Lo(ka),radius:uo(ya),roundBars:Lo(Ca),showFPS:Lo(Ut),showScaleY:+uo(_a),smoothing:uo(Ha),spinSpeed:uo(ja),splitGradient:Lo(Ua),weightingFilter:uo(Qa)}),Ds([At,Mt,It,Dt,Pa,Gt,Yt,Qt,Oa,Sa,Wt,Kt,...n?[]:[wa],Ot,Da,Aa,sa]),"demo"==e&&vs(!0),t&&M().alert({text:"Settings loaded!"}))}async function os(e){Ko(ga);const t=new Option("Select a playlist","");t.disabled=!0,t.selected=!0,ga.options[ga.options.length]=t;let a=await(0,_.Jt)(Ce);const n=ts(Ce);if(n){for(const e of Object.keys(n)){const t=_e+e,o=ts(t);let s=[];for(const e of o)s.push({file:e});await(0,_.hZ)(t,s),ks(t),a[e]=n[e]}await(0,_.hZ)(Ce,a),ks(Ce)}if(a){const t=Object.keys(a),n=new Intl.Collator;t.sort(((e,t)=>n.compare(a[e],a[t])));for(const n of t){const t=new Option(a[n],n);n==e&&(t.selected=!0),ga.options[ga.options.length]=t}}}async function ss(e,t){const a=e!==B,n=a?e:En<Ao()-1?En+1:0,o=Wn[a?kn:Ln],s=Sn.children[n];a||Fs();let r=!1;if(s){if(a&&(En=n),Fo(s,o),rs(o,s),s.handle)try{await s.handle.requestPermission();const e=await s.handle.getFile();await es(e,o,t),r=!0}catch(e){Go(`Error loading ${s.dataset.file}`,!0),Uo(o)}else{Qo(o,s.dataset.file);try{await Do(o),a&&t&&o.play(),r=!0}catch(e){}}r&&(a?(Vs(),ss(B)):o.load()),s.classList.toggle("error",!r)}return a||(eo=!1),r}async function rs(e,t){const a=e.querySelector("track");go(a.src)&&URL.revokeObjectURL(a.src);let{subs:n}=t||{};if(t&&!n&&Lo(Da)&&!ko(t.dataset.file)){const{path:e,baseName:a}=To(t.dataset.file);let o;if(!t.dirHandle&&t.handle||(o=await E(e,t.dirHandle)),o){const e=o.files.find((e=>e.name.startsWith(a)));e&&e.subs&&(n=e.subs,t.subs=n)}}if(n){const{src:e,lang:t,handle:o}=n;a.srclang=t||navigator.language,o?o.getFile().then((e=>a.src=URL.createObjectURL(e))).catch((e=>{})):a.src=e}else a.removeAttribute("src"),a.removeAttribute("srclang")}function is(e){e?(Xn.name+=" (copy)",Xn.key=""):Xn={name:"New Gradient",bgColor:"#111111",colorStops:[{pos:.1,color:"#222222"},{pos:1,color:"#eeeeee"}],disabled:!1,key:""},ys(),Ro(Lt("#btn-delete-gradient"),!1),Ro(Lt("#btn-save-gradient"),!0),Ro(Lt("#btn-export-gradient"),!1),Ro(Lt("#btn-save-gradient-copy"),!1),location.href="#gradient-editor"}function ls(e){if(eo||Na.checked||En>Ao()-1)return!0;if(eo=!0,En<Ao()-1)En++;else{if(!Lo(Ea))return eo=!1,!1;En=0}return e|=xo(),[kn,Ln]=[Ln,kn],Ps(),Os(),e&&Wn[kn].src?Wn[kn].play().then((()=>ss(B))).catch((e=>{e.code!=ie&&(Go(e,!0),ss(B),ls(!0))})):ss(B),Vs(),!0}function cs(e){Na.checked||(xo()&&!e?(Wn[kn].pause(),wo()&&oo.pause()):Wn[kn].play().catch((e=>{e.code!=ie&&(Go(e,!0),ls(!0))})))}function ds(){let e=!0;return xo()?Wn[kn].currentTime>2?Wn[kn].currentTime=0:En>0?us(En-1):e=!1:e=ss(En-1),e}function us(e){ss(e,!0)}function fs(){let e=[{value:j,text:"Album cover"},{value:N,text:"Black"},{value:q,text:"Gradient default"}];const t=e.length,a=Kn.length,n=Yn.length;e=[...e,...Kn.map(((e,t)=>({value:U+e.name,text:"ðŸ–¼ï¸ "+e.name,idx:t}))),...Yn.map(((e,t)=>({value:z+e.name,text:"ðŸŽ¬ "+e.name,idx:t})))].slice(0,t+ +Rt.value),n&&e.splice(t,0,{value:z,text:"Random video"}),a&&e.splice(t,0,{value:U,text:"Random image"}),gs(At,e)}function ps(e,t,a){a||(a=e.dataset.prop);const n=!Array.isArray(t[0]);for(const o of n?t.filter((e=>!e.disabled)):t){const t=o.text||o[1],n=o.value||o[0],s=a+"-"+n,r=document.createElement("input"),i=document.createElement("label");r.name=a,r.id=s,r.type="radio",r.value=n,i.htmlFor=s,i.innerText=t,e.append(r,i)}}function hs(){const e=Lt("#enabled_gradients"),t=Object.keys(tn),a=new Intl.Collator;t.sort(((e,t)=>a.compare(tn[e].name,tn[t].name))),Ko(e),t.forEach((t=>{e.innerHTML+=`<label>\n\t\t\t\t<input type="checkbox" class="enabledGradient" data-grad="${t}" ${tn[t].disabled?"":"checked"}>\n\t\t\t\t${tn[t].name}<a href="#" data-grad="${t}" class="grad-edit-link">Edit / Export</a>\n\t\t\t</label>`})),St(".enabledGradient").forEach((e=>{e.addEventListener("click",(t=>{if(!e.checked&&Object.keys(tn).reduce(((e,t)=>e+!tn[t].disabled),0)<2)return M().alert({text:"At least one Gradient must be enabled!"}),t.preventDefault(),!1;tn[e.dataset.grad].disabled=!e.checked,ms(),Es(ge)}))})),St(".grad-edit-link").forEach((e=>{e.addEventListener("click",(e=>{var t;e.preventDefault(),function(e){if(!tn[e])throw new Error(`gradients[${e}] is null or undefined.`);const t=(e,t,a)=>{const n=t*Math.min(a,1-a),o=(t,o=(t+e/30)%12)=>a-n*Math.max(Math.min(o-3,9-o,1),-1);let s="#";for(const e of[0,8,4])s+=Math.round(255*o(e)).toString(16).padStart(2,"0");return s},a=e=>e.match(/\(\s+(.*),\s+(.*?)%?,\s+(.*?)%?\s+\)/).slice(1),n=tn[e],o={...n};o.colorStops=[];for(const e of n.colorStops){if(e.color.startsWith("rgb")){const{color:t}=e;e.color="#";for(const n of a(t))e.color+=(+n).toString(16).padStart(2,"0")}else if(e.color.startsWith("hsl")){const[n,o,s]=a(e.color);e.color=t(n,o/100,s/100)}else if(4==e.color.length){const[t,a,n,o]=e.color;e.color="#"+a+a+n+n+o+o}o.colorStops.push({...e})}Xn=o}(t=e.target.getAttribute("data-grad")),ys(),Ro(Lt("#btn-delete-gradient"),!!tn[t].key),Ro(Lt("#btn-save-gradient"),!!tn[t].key),Ro(Lt("#btn-export-gradient"),!0),Ro(Lt("#btn-save-gradient-copy"),!0),location.href="#gradient-editor"}))}))}function ms(){const e=Object.keys(tn),t=new Intl.Collator;e.sort(((e,a)=>t.compare(tn[e].name,tn[a].name)));for(const t of[Wt,Kt]){let a=t.value;Ko(t);for(const a of e)tn[a].disabled||(t.options[t.options.length]=new Option(tn[a].name,a));""!==a&&(t.value=a,Ds(t))}}function bs(){const e=(e,t)=>{const a=document.createElement("optgroup");a.label=e;for(const[e,n]of t)a.appendChild(new Option(n,e));va.appendChild(a)};Ko(va),va.appendChild(new Option("Select a preset to load",""));const t=_n.map(((e,t)=>[t,e.name?`[${t+1}] ${e.name}`:""])).filter((([e,t])=>!!t));t.length&&e("User Presets",t),e("Built-in Presets",en.filter((e=>![qe,Be].includes(e.key))).map((e=>[e.key,e.name])))}function gs(e,t){const a=e.value;Array.isArray(t)||(t=[t]),Ko(e);for(const a of t.filter((e=>e&&!e.disabled))){const t=new Option(a.text||a[1],a.value||a[0]);null===a[0]&&(t.disabled=!0),void 0!==a.idx&&(t.idx=a.idx),e[e.options.length]=t}""!==a&&(e.value=a,-1==e.selectedIndex&&(e.selectedIndex=0),Ds(e))}function vs(e=Na.checked){if(!xo()&&!e)return;const t=e=>!on.find((t=>t.value==e)).disabled,a=(e,t=()=>!0)=>{let a=9;do{if(vo(e)){const t=e.elements[e.dataset.prop];t[_o(t.length)].checked=!0}else if(void 0!==e.dataset.active)e.dataset.active=_o();else if(e.step){const{min:t,max:a,step:n}=e,o=_o((a-t)/n+1)*n+ +t;Mo(e,(10*o|0)/10)}else e.selectedIndex=_o(e.options.length)}while(!t(uo(e))&&a--);Ds(e)};if(t(nt)){const e=_n.map(((e,t)=>yo(e)?null:t)).filter((e=>null!==e)),t=e.length;t&&ns(e[_o(t)],!1,!1,!0)}if(t(et)&&a(sa),t(We)&&a(Et),t(Ke)&&a(At),t(Ye)&&a(_t),t(Je)&&a(Mt),t(Xe)&&a(Ht),t(at)&&a(Pa),t(Ze)&&a(Xt),t(Qe)&&a(ta,(e=>!+e||!vn.overlay||!Lo(Xt))),t(tt)&&a(da),t(st)&&a(Sa,(e=>e!=ze||!Lo(Xt))),t(ot)&&a(ka),t(rt)&&a(Ca),t(it)&&a(Ua),t(Ve))for(const e of[Wt,...Lo(Qt)?[]:[Kt]])a(e)}function ks(e){localStorage.removeItem(e)}function ys(){if(null==Xn)throw new Error("Current gradient must be set before editing gradient");const e=Lt("#grad-color-table");Ko(e),Lt("#new-gradient-name").value=Xn.name,Lt("#new-gradient-horizontal").checked="h"===Xn.dir;const t=Lt("#grad-row-label-template").cloneNode(!0);t.removeAttribute("id"),e.appendChild(t),Xn.colorStops.forEach(((e,t)=>{!function(e,t){const a=Lt("#grad-color-table"),n=Lt("#grad-row-template").cloneNode(!0),o=n.querySelector(".grad-color-picker"),s=n.querySelector(".grad-color-value"),r=n.querySelector(".grad-color-stop"),i=n.querySelector(".grad-add-stop"),l=n.querySelector(".grad-remove-stop");o.value=t.color,s.value=t.color,r.value=t.pos,o.addEventListener("input",(t=>{s.value=t.target.value,Xn.colorStops[e].color=o.value})),s.addEventListener("input",(t=>{o.value=t.target.value,Xn.colorStops[e].color=o.value})),r.addEventListener("input",(t=>{Xn.colorStops[e].pos=parseFloat(t.target.value)})),i.addEventListener("click",(()=>{Xn.colorStops.splice(e+1,0,{pos:(()=>{if(e===Xn.colorStops.length-1){const e=Xn.colorStops[Xn.colorStops.length-1].pos;return Xn.colorStops[Xn.colorStops.length-1].pos=(Xn.colorStops[Xn.colorStops.length-2].pos+e)/2,e}return(Xn.colorStops[e].pos+Xn.colorStops[e+1].pos)/2})(),color:"#111111"}),ys()})),2===Xn.colorStops.length?l.setAttribute("disabled","true"):l.addEventListener("click",(()=>{Xn.colorStops.splice(e,1),ys()})),n.removeAttribute("id"),a.appendChild(n)}(t,Xn.colorStops[t])})),Lt("#new-gradient-bkgd").value=Xn.bgColor}async function ws(){const e=Pt.value,t=new RegExp("\\.("+ce.join("|")+")$","i"),a=new RegExp("\\.("+ue.join("|")+")$","i");if(Kn=[],Yn=[],e==W)try{const e=await fetch(D),n=await e.text();for(const{url:e,file:o}of T(n)){const n=To(o).baseName;t.test(o)?Kn.push({name:n,url:D+"/"+e}):a.test(o)&&Yn.push({name:n,url:D+"/"+e})}}catch(e){}else if(e==K){const e=await(0,_.Jt)(pe);try{if(e)for await(const[n,o]of e.entries())if(o instanceof FileSystemFileHandle){const e=t.test(n),s=a.test(n);if(e||s){const t=await o.getFile(),a=URL.createObjectURL(t);e?Kn.push({name:n,url:a}):Yn.push({name:n,url:a})}}}catch(e){}}if(e!=G){const e=Kn.length,t=Yn.length;Go("Found "+(e+t==0?"no media":e+" image files and "+t+" video")+" files in the backgrounds folder")}fs()}async function xs(){if(to>=H)return;const e=Array.from(Sn.children).find((e=>e.dataset.retrieve));if(e){let t=e.dataset.file,a=!1;to++,delete e.dataset.retrieve;e:{if(e.handle)try{if("granted"!=await e.handle.requestPermission())break e;t=URL.createObjectURL(await e.handle.getFile()),a=!0}catch(e){break e}try{const a=await A.WC(t,{skipPostHeaders:!0});a&&(Fo(a,e),Ks(e),a.common.picture&&a.common.picture.length||async function(e){const{path:t}=To(e.dataset.file),{dirHandle:a}=e;if(!In||ko(t))return"";if(void 0!==Vn[t])return Vn[t];{if(e.handle&&!a)return"";let n="";try{const e=await E(t,a);if(e&&e.cover){const{handle:a,name:o}=e.cover;if(a){const e=await a.getFile();n=URL.createObjectURL(e)}else n=t+o}}catch(e){}return Vn[t]=n,n}}(e).then((t=>{e.dataset.cover=t,Ks(e)})))}catch(e){}a&&URL.revokeObjectURL(t)}to--,xs()}}function Ls(e){const t=e.dataset.cover;go(t)&&URL.revokeObjectURL(t)}function Ss(e){if(null!==Xn){if(!Xn.key||e){let t=e&&Xn.key||io(Xn.name);Xn.key=t;let a=1;for(;Object.keys(tn).some((e=>e===Xn.key))&&a<1e3;)Xn.key=`${t}-${a}`,a++;for(a=1;Object.keys(tn).some((e=>tn[e].name===Xn.name))&&a<1e3;)Xn.name+=` (${a})`,a++}tn[Xn.key]=Xn,vn.registerGradient(Xn.key,Xn),ms(),hs(),Es(he),Xn=null,location.href="#config"}}function Es(e){const t=e=>e.map((({value:e,disabled:t})=>({value:e,disabled:t})));if(e&&e!=be||Cs(be,t(ln)),e&&e!=ge||Cs(ge,Object.keys(tn).map((e=>({value:e,disabled:tn[e].disabled})))),!e||e==he){const e={};Object.keys(tn).filter((e=>tn[e].key)).forEach((t=>e[t]=tn[t])),Cs(he,e)}if(e&&e!=ve||Cs(ve,t(on)),!e||e==$e){let e=[];for(const t of[0,1,2])e.push({min:Lt(`.min-db[data-preset="${t}"]`).value,max:Lt(`.max-db[data-preset="${t}"]`).value,boost:Lt(`.linear-boost[data-preset="${t}"]`).value});Cs($e,e)}if(!e||e==ke){const e={info:Jt.value,track:Ja.value,end:qt.value,covers:Ma.checked,count:Ia.checked};Cs(ke,e)}if(!e||e==we){const e={autoHide:$t.checked,bgLocation:Pt.value,bgMaxItems:Rt.value,fsHeight:Gt.value,maxFPS:aa.value,noDimSubs:ia.checked,noDimVideo:la.checked,pipRatio:ba.value,saveDir:Ta.checked,saveQueue:$a.checked,surround:Ka.checked};Cs(we,e)}if(!e||e==Ee){const e={gravity:Yt.value,peakFade:ha.value,peakHold:ma.value};Cs(Ee,e)}if(!e||e==Ae){const e={background:za.value,color:Ga.value,position:Wa.value};Cs(Ae,e)}}function Cs(e,t){localStorage.setItem(e,JSON.stringify(t))}function Ts(e,t,a,n){const o=`User Preset #${e+1}`,s=_n[e].name||"",r=vn.isFullscreen;if(!yo(_n[e])&&!n&&Qn!==e)return void(r?(_s(`Overwrite ${o} - Press again to confirm!`,5),Qn=e,setTimeout((()=>{Qn===e&&(Qn=!1)}),5e3)):M().confirm({text:`Do you really want to overwrite ${o}?<br>${s}`,submitText:"Overwrite",submitCallback:()=>{Ts(e,t,a,!0)},cancelCallback:()=>{M().alert({text:"Canceled!"})}}));if(Qn=!1,!a||!`${a}`.trim()){if(!r)return void M().input({text:"Give this preset a name or short description",submitText:"Save",value:s,maxlength:40,submitCallback:a=>{Ts(e,t,a.trim()||Ne,!0)},cancelCallback:()=>{M().alert({text:"Save canceled!"})}});a=""}a==Ne&&(a=""),_n[e]={name:a,options:t},Cs(me,_n);const i=`Saved to ${o}`;r?_s(i,5):M().alert({text:i}),bs()}function $s(e,t=1){wn=setTimeout((()=>{Zn=e,Jo(t)}),200)}function As(e){document.documentElement.style.setProperty("--background-image",e?`url('${e.replace(/['()]/g,"\\$&")}')`:"none")}function _s(e,t=2,a=-1){if(e){const n=performance.now(),o=n+1e3*t;e==+e?(Jn.info=e,Jn.startTime=n,Jn.endTime=Math.max(o,Jn.endTime||0),Jn.fade=t==1/0?0:t/3*a):(Jn.msg=e,2==Jn.info&&(Jn.info=1),Jn.msgTimer=o)}else Jn={endTime:0,msgTimer:0}}function Os(){no.src=Wn[kn].dataset.cover,At.value==j&&As(no.src)}function Is(e){$t.checked=e.autoHide,Pt.value=e.bgLocation,Rt.value=e.bgMaxItems,Gt.value=e.fsHeight,aa.value=e.maxFPS,ia.checked=e.noDimSubs,la.checked=e.noDimVideo,fa.value=e.osdFontSize,ba.value=e.pipRatio,Ta.checked=e.saveDir,$a.checked=e.saveQueue,Ka.checked=e.surround}function Ms(e){Jt.value=e.info,Ja.value=e.track,qt.value=e.end,Ma.checked=e.covers,Ia.checked=e.count}function Ps(){const e=At.value[0],t=Lo(Da)&&!!Wn[kn].querySelector("track").src,a=So(),n=a||t||e!=q&&e!=N;for(const e of Wn)Ro(e,(a||t)&&e==Wn[kn]);return vn.overlay=n,vn.showBgColor=!a&&e==q,Ft.style.backgroundImage=a?"none":"var(--background-image)",Ro(Xa,e==z&&!a),Ro(Bt,!(a&&la.checked||t&&ia.checked)),n}function Rs(e){Yt.value=e.gravity,ha.value=e.peakFade,ma.value=e.peakHold}function Ds(e,t=!0){Array.isArray(e)||(e=[e]);const a=()=>Ro(Kt,uo(Dt)!=ne&&!Lo(Qt));for(const n of e){switch(n){case Et:vn.alphaBars=Lo(Et);break;case Tt:vn.ansiBands=+uo(Tt);break;case $t:Ys(!0);break;case At:const e=At.value[0],o=At[At.selectedIndex].idx,s=Ps();if(e==z){As();const e=Yn[void 0===o?_o(Yn.length):o].url;try{decodeURIComponent(Xa.src).endsWith(decodeURIComponent(e))||(Xa.src=e)}catch(t){Xa.src=e}}else s&&![q,N].includes(e)?As(e==j?no.src:Kn[void 0===o?_o(Kn.length):o].url):As();break;case _t:Mo(sa,uo(_t)),Ds(sa,!1);break;case Ot:const r=uo(Ot);vn.barSpace=vn.isLumiBars||1==r?1.5:r;break;case Mt:const i=Mt.value,l=i==Z||i==Q||i==ee;Ft.classList.toggle("repeat",i==X),Ft.classList.toggle("cover",i==Y||l),Ft.style.backgroundSize="",Ro(Za,l),Za.classList.toggle("rotating",i==ee),Za.classList.toggle("paused",i==Z);break;case It:Bt.style.background=`rgba(0,0,0,${1-It.value})`;break;case Pt:Pt.value==K?window.showDirectoryPicker({startIn:"pictures"}).then((e=>{(0,_.hZ)(pe,e)})).catch((e=>{Pt.value=G,(0,_.yH)(pe)})).finally((()=>ws())):((0,_.yH)(pe),ws());break;case Rt:fs();break;case Dt:vn.channelLayout=uo(Dt),a();break;case Ht:vn.colorMode=uo(Ht);break;case jt:vn.fillAlpha=jt.value;break;case Nt:vn.fftSize=uo(Nt),Go("FFT size is "+vn.fftSize+" samples");break;case Ut:vn.showFPS=Lo(Ut);break;case zt:vn.frequencyScale=uo(zt);break;case Gt:Ct.style.height=`${Gt.value}%`;break;case Wt:case Kt:""===n.value&&(n.selectedIndex=0),Lo(Qt)?vn.gradient=Wt.value=Kt.value=n.value:vn[n==Wt?"gradientLeft":"gradientRight"]=n.value;break;case Xt:vn.ledBars=Lo(Xt);break;case Vt:vn.linearAmplitude=+uo(Vt);break;case Zt:vn.lineWidth=Zt.value;break;case Qt:a(),Lo(Qt)&&Ds(Wt,!1);break;case ea:vn.loRes=Lo(ea);break;case ta:vn.lumiBars=Lo(ta),Ds(Ot,!1);break;case aa:vn.maxFPS=aa.value;break;case oa:vn.mirror=uo(oa);break;case sa:const c=uo(sa);vn.mode=c==Oe?uo(_t):c,Ds(Ot,!1);break;case ra:Zs();break;case ia:case la:Ps();break;case fa:zo();break;case da:vn.outlineBars=Lo(da);break;case Yt:vn.gravity=Yt.value;break;case ha:vn.peakFadeTime=ha.value;break;case ma:vn.peakHoldTime=ma.value;break;case ba:wo()&&(vn.width=vn.height*ba.value);break;case ka:vn.radial=Lo(ka),Ds(Ot,!1);break;case ya:vn.radius=uo(ya);break;case wa:const d=wa.value;Cn&&(Cn=clearInterval(Cn)),d>1&&(Cn=setInterval(vs,2500*d));break;case La:case xa:for(;+xa.value<=+La.value;)xa.selectedIndex++;vn.setFreqRange(La.value,xa.value);break;case Sa:switch(uo(Sa)){case Ge:vn.reflexRatio=.25,vn.reflexAlpha=.2;break;case Ue:vn.reflexRatio=.4,vn.reflexAlpha=.2;break;case ze:vn.reflexRatio=.5,vn.reflexAlpha=1;break;default:vn.reflexRatio=0}break;case Ca:vn.roundBars=Lo(Ca);break;case Ta:Ta.checked?Oo(h):((0,_.yH)(Le),ks(Le));break;case $a:$a.checked?Ws(!0):(0,_.yH)(Te);break;case Aa:vn.showScaleX=uo(Aa)!=dt,vn.noteLabels=uo(Aa)==ut;break;case _a:vn.showScaleY=+uo(_a);break;case Oa:const u=uo(Oa);vn.setSensitivity(Lt(`.min-db[data-preset="${u}"]`).value,Lt(`.max-db[data-preset="${u}"]`).value),vn.linearBoost=Lt(`.linear-boost[data-preset="${u}"]`).value;break;case Pa:vn.showPeaks=uo(Pa)!=He,vn.fadePeaks=uo(Pa)==Fe;break;case Da:Fs();break;case Ha:vn.smoothing=Ha.value,Go("smoothingTimeConstant is "+vn.smoothing);break;case Na:const f=Na.checked;t=!1,Hs(f,(e=>{f&&e?(On=ra.checked,Zs(!0)):f||Zs(!!On),Qs()}));break;case ja:vn.spinSpeed=ja.value;break;case Ua:vn.splitGradient=Lo(Ua);break;case za:case Ga:Ft.className=Ft.className.replace(new RegExp(`(${bt}|${gt}).*`,"gi"),""),Ft.classList.add(bt+za.value,gt+Ga.value);break;case Wa:qs({target:Wn[kn].querySelector("track")});break;case Ka:Xs();break;case Qa:vn.weightingFilter=uo(Qa)}t&&(cn.includes(n)?Es(we):pn.includes(n)?Es(Ee):mn.includes(n)?Es(Ae):Qs())}}async function Hs(e,t){Na.checked=e,e?navigator.mediaDevices?navigator.mediaDevices.getUserMedia({audio:!0}).then((e=>{xn=vn.audioCtx.createMediaStreamSource(e),xo()&&Wn[kn].pause(),vn.connectInput(xn),Go("Audio source set to microphone")})).catch((e=>{Go(`Could not change audio source - ${e}`,!0),Na.checked=!1})).finally((()=>{t&&t(Na.checked)})):(Go("Cannot access user microphone",!0),Na.checked=!1,t&&t(!1)):(xn&&(vn.disconnectInput(xn),xn.mediaStream.getTracks()[0].stop(),xn=null),Go("Audio source set to built-in player"),t&&t(!0))}function Fs(){for(const e of Wn)e.textTracks[0].mode="hidden",Lo(Da)&&(e.textTracks[0].mode="showing");Ps()}function Bs(e){za.value=e.background,Ga.value=e.color,Wa.value=e.position}function qs(e){if(!e.target.track)return;let t,a,n=!1;switch(Wa.value){case vt:t="end",a=95;break;case kt:t="center",a=50;break;default:t="start",a=1,n=!0}for(const o of e.target.track.cues)o.line=a,o.snapToLines=n,o.lineAlign=t}function Ns(e){Va.dataset.value=e,vn.volume=e**2.5,Va.querySelector(".marker").style.transform=`rotate( ${125+290*e}deg )`}function js(){let e;Ft.addEventListener("mouseenter",(()=>{$t.checked&&!vn.isFullscreen&&(e=setTimeout((()=>Ys(!1)),500))})),Ft.addEventListener("mouseleave",(()=>clearTimeout(e))),Ya.addEventListener("click",(()=>Ys())),Ft.addEventListener("transitionend",(()=>{if(Ft.style.height)for(const e of gn)Ro(Lt(`#${e.value}`),!1);document.body.style.overflowY=window.innerHeight<xt?"scroll":""}));const t=pa.panel;let a;t.forEach((e=>{e.addEventListener("click",(a=>{t.forEach((e=>Lt(`#${e.value}`).classList.toggle("active",e==a.target))),Ys(!0),"console"==e.value&&(yn.classList.remove("warning"),Go())}))})),Lt(`#panel-${gn[0].value}`).checked=!0,na.classList.add("active"),Lt("#console-clear").addEventListener("click",(()=>Go("Console cleared.",!1,!0))),St(".switch").forEach((e=>{e.addEventListener("click",(()=>{e.dataset.active=+!+e.dataset.active,Ds(e)}))})),St("[data-prop]").forEach((e=>{vo(e)?e.elements[e.dataset.prop].forEach((t=>{t.addEventListener("click",(()=>Ds(e)))})):e.addEventListener("input",(()=>{Ds(e),er(e)}))})),Va.addEventListener("wheel",(e=>{e.preventDefault(),a||(a=setTimeout((()=>a=!1),50),jo(Math.sign(e.deltaY||0)))})),Lt("#btn_play").addEventListener("click",(()=>cs())),Lt("#btn_stop").addEventListener("click",Gs),Lt("#btn_shuf").addEventListener("click",Us),Lt("#btn_prev").addEventListener("mousedown",(()=>$s("m",-1))),Lt("#btn_prev").addEventListener("click",(e=>{Xo()||zs(!0)})),Lt("#btn_next").addEventListener("mousedown",(()=>$s("m"))),Lt("#btn_next").addEventListener("click",(()=>{Xo()||zs()})),qa.addEventListener("input",(()=>{const e=Wn[kn],{duration:t}=e;t&&t!=1/0?e.currentTime=t*qa.value:qa.value=0})),va.addEventListener("input",(()=>{const e=va.value;e&&(M().confirm({text:`Load preset ${co(va)}?`,submitText:"LOAD",submitCallback:()=>ns(e)}),va.value="")})),Lt("#btn_manage_presets").addEventListener("click",(()=>{const e=[];_n.map(((e,t)=>`<strong>[${t+1}]</strong>&nbsp; ${yo(e)?'<em class="empty">Empty slot</em>':e.name||Ne}`)).forEach(((t,a)=>{const n=_n[a].options;e.push({type:1,text:t,handler:()=>Ts(a,fo())},{type:2,text:yo(n)?"":'<button title="Edit name">&#xf11f;</button>',handler:()=>Ts(a,n,"",!0)},{type:2,text:yo(n)?"":'<button title="Delete preset">&#xf120;</button>',handler:()=>Yo(a)})})),M().select({text:"<strong>Click slot to SAVE - Use buttons to Rename or Delete</strong>",choices:e})}));for(const[e,t]of[[Lt("#preset_last"),qe],[Lt("#preset_default"),Be]])e.addEventListener("click",(()=>{M().confirm({text:`Restore all options in <strong>Settings</strong> and <strong>Advanced</strong> panels to ${t==Be?"defaults":"session start"}?`,submitText:"RESTORE",submitCallback:()=>ns(t)})}));Lt("#btn_clear").addEventListener("click",(()=>{!function(){for(;Sn.hasChildNodes();)Ls(Sn.removeChild(Sn.firstChild));xo()?En=-1:(En=0,Uo(kn)),Uo(Ln),Vs()}(),Ws(!0)})),Lt("#create_playlist").addEventListener("click",(()=>Ws())),Lt("#delete_playlist").addEventListener("click",(()=>{return e=ga.selectedIndex,void(ga[e].value&&M().confirm({text:`Do you really want to DELETE the "${ga[e].innerText}" playlist?<br>THIS CANNOT BE UNDONE!`,submitText:"Delete",submitCallback:async()=>{const t=ga[e].value,a=_e+t,n=await(0,_.Jt)(Ce);n&&delete n[t],await(0,_.yH)(a),await(0,_.hZ)(Ce,n),M().alert({text:"Playlist deleted"}),os()},cancelCallback:()=>{M().alert({text:"Canceled"})}}));var e})),Lt("#load_playlist").addEventListener("click",(()=>{as({file:ga.value}).then((e=>{const t=-1==e?"No playlist selected":`${e} song${e>1?"s":""} added to the queue`;M().alert({text:t,time:5})}))})),Lt("#save_playlist").addEventListener("click",(()=>{var e;(e=ga.selectedIndex)?M().confirm({text:`Overwrite "${ga[e].innerText}" with the current play queue?`,submitText:"Overwrite",submitCallback:()=>{Ws(ga[e].value)},cancelCallback:()=>{M().alert({text:"Canceled"})}}):Ws()})),ua.addEventListener("click",(()=>Js()));const n=Lt("#btn_toggle_filesystem"),s=()=>n.innerText="Switch to "+(An?"Server":"Device");(Tn||An)&&$n?(s(),n.addEventListener("click",(async()=>{An=!An;const e=An?await(0,_.Jt)(Le):ts(Le);An&&e&&"granted"!=await e[0].handle.requestPermission()?An=!1:(v=!v,h=[],c=null,b=[v?r:o],$(e),s(),Cs(ye,An))}))):Ro(n,!1);const i=Lt("#btn_add_selected"),l=Lt("#btn_add_folder");Tn||An?(i.addEventListener("mousedown",(()=>Ho(S(".selected")))),l.addEventListener("click",(()=>Ho(S())))):(Ro(i,!1),Ro(l,!1));const d=Lt("#local_file");let u,f;$n?Ro(d.parentElement,!1):d.addEventListener("change",(e=>function(e){const t=e.files[0];if(t){Uo();const e=Wn[kn];e.dataset.file=t.name,e.dataset.title=To(t.name).baseName,es(t,e,!0).then((e=>A.WC(e))).then((t=>Fo(t,e))).catch((e=>{}))}}(e.target))),Lt("#btn_load_url").addEventListener("click",(()=>{M().input({text:"Load audio file or stream from URL",submitText:"Load",submitCallback:e=>{e.trim()&&(qo({file:e},!0),Ws(!0))}})})),Lt("#btn_fullscreen").addEventListener("click",Vo);const p=Lt("#btn_pip");document.pictureInPictureEnabled?p.addEventListener("click",(async()=>{if(oo!==document.pictureInPictureElement){const e=vn.canvas.captureStream();u=e.getTracks()[0],oo.muted=!0,oo.srcObject=e,await oo.play(),oo.requestPictureInPicture()}else document.exitPictureInPicture()})):p.classList.add("disabled");const m=((e,t=300)=>{let a;return(...n)=>{clearTimeout(a),a=setTimeout((()=>e.apply(this,n)),t)}})((()=>vn.setCanvasSize(f.width,f.height)));oo.addEventListener("enterpictureinpicture",(e=>{f=e.pictureInPictureWindow,Ft.classList.add("pip"),p.classList.add("active"),vn.setCanvasSize(f.height*ba.value,f.height),f.addEventListener("resize",m)})),oo.addEventListener("leavepictureinpicture",(()=>{f.removeEventListener("resize",m),oo.pause(),u.stop(),oo.srcObject=u=null,p.classList.remove("active"),Ft.classList.remove("pip"),vn.setCanvasSize()}));const g=navigator.mediaSession;g&&(g.setActionHandler("play",(()=>cs())),g.setActionHandler("pause",(()=>cs())),g.setActionHandler("previoustrack",(()=>ds())),g.setActionHandler("nexttrack",(()=>ls()))),Lt("#add-gradient").addEventListener("click",(()=>is())),Lt("#btn-save-gradient").addEventListener("click",(()=>Ss())),Lt("#btn-save-gradient-copy").addEventListener("click",(()=>is(!0))),Lt("#btn-delete-gradient").addEventListener("click",(()=>{M().confirm({text:`Do you really want to DELETE <strong>${Xn.name}</strong>?<br>THIS CANNOT BE UNDONE!`,submitText:"DELETE",submitCallback:()=>{Xn&&Xn.key&&(delete tn[Xn.key],0===Object.keys(tn).filter((e=>!tn[e].disabled)).length&&(tn[Object.keys(tn)[0]].disabled=!1),ms(),hs(),Es(he),Es(ge),Xn=null,location.href="#config")}})}));const k=Lt("#btn-export-gradient");k.addEventListener("click",(()=>{k.setAttribute("href",so(Xn)),k.setAttribute("download",`audioMotion-gradient-${Xn.key}.json`)}));const y=Lt("#import_gradient");y.addEventListener("input",(()=>{const e=y.files[0];y.value="",e.text().then((e=>{try{Xn=JSON.parse(e)}catch(e){return void Go(e,!0)}Ss(!0)}))})),Lt("#new-gradient-bkgd").addEventListener("input",(e=>{Xn.bgColor=e.target.value})),Lt("#new-gradient-name").addEventListener("input",(e=>{Xn.name=e.target.value})),Lt("#new-gradient-horizontal").addEventListener("input",(e=>{Xn.dir=e.target.checked?"h":void 0}));const w=St("details");w.forEach((e=>{e.addEventListener("click",(()=>{e.open||w.forEach((e=>e.open=!1))}))}));const x=Lt("#export_settings");x.addEventListener("click",(()=>{x.setAttribute("href",so(fo())),x.setAttribute("download","audioMotion-settings.json")}));const L=Lt("#import_settings");L.addEventListener("input",(()=>{const e=L.files[0];L.value="",M().confirm({text:"ATTENTION!<br>This will overwrite all current options in the <strong>Settings</strong> and <strong>Advanced</strong> panels!",submitText:"IMPORT",submitCallback:()=>{e.text().then((e=>{try{ns(JSON.parse(e))}catch(e){Go(e,!0)}}))}})}))}function Us(){for(let e=Ao()-1;e>0;e--){const t=Math.random()*(e+1)|0,a=Sn.replaceChild(Sn.children[t],Sn.children[e]);Sn.insertBefore(a,Sn.children[t])}us(0),Ws(!0)}function zs(e=!1){(e?ds():ls())||_s(`Already at ${e?"first":"last"} track`)}function Gs(){Wn[kn].pause(),_s(),ss(0)}async function Ws(e,t=!0){const a=1==e;if(!a||$a.checked)if(0!=Ao()||a)if(e){let n;if(!a&&!t){n=io(e,"_");let t=await(0,_.Jt)(Ce)||{},a=0,o=n;for(;t.hasOwnProperty(n)&&a<1e3;)n=o+"_"+a,a++;t[n]=e,await(0,_.hZ)(Ce,t),os(n)}let o=[];for(const e of Sn.childNodes){const{album:t,artist:a,codec:n,duration:s,file:r,title:i}=e.dataset,{handle:l,dirHandle:c}=e;o.push({file:r,handle:l,dirHandle:c,content:{album:t,artist:a,codec:n,duration:s,title:i}})}a?(0,_.hZ)(Te,o):(0,_.hZ)(_e+n,o).then((()=>M().alert({text:"Playlist saved!"})))}else M().input({text:"Give this playlist a name:",submitText:"Save",submitCallback:e=>{e&&Ws(e,!1)},cancelCallback:()=>{M().alert({text:"Canceled"})}});else M().alert({text:"Queue is empty!"})}function Ks(e){for(const t of Wn)t.dataset.file==e.dataset.file&&Fo(e,t)}function Ys(e){if(void 0===e&&(e=!!Ft.style.height),window.innerHeight>=xt&&(document.body.style.overflowY="hidden"),e)for(const e of gn)Ro(Lt(`#${e.value}`),!0);const t=Lt(".player-panel").clientHeight+Lt(".bottom-panel").clientHeight+10;Ft.style.height=e?"":`calc( 100vh - ${t}px )`,Ya.classList.toggle("closed",!e)}function Js(){Jn.endTime<performance.now()&&(Jn.info=0),2==Jn.info?_s():_s(1+(0|Jn.info),+Jt.value||1/0)}function Xs(){const{destination:e}=vn.audioCtx,{maxChannelCount:t}=e,a=Ka.checked;e.channelCount=Math.min(a?6:2,t),Go(`Surround audio output ${a?"enabled":"disabled"}. Device supports ${t} channels; channels in use: ${e.channelCount}`)}function Vs(){const e=Sn.querySelector(".current"),t=Sn.children[En];e&&e.classList.remove("current"),t&&(t.classList.add("current"),t.scrollIntoViewIfNeeded())}function Zs(e){void 0!==e?ra.checked=e:e=ra.checked,e?vn.disconnectOutput():vn.connectOutput()}function Qs(){Cs(xe,{...fo(),micSource:Na.checked,mute:ra.checked,volume:Va.dataset.value})}function er(e){const t=e.previousElementSibling;t&&"value"==t.className&&(t.innerText=(t=>{const{abs:a,sign:n}=Math;return e==_t?["","10 bands (octaves)","20 bands (half octaves)","30 bands (1/3rd oct.)","40 bands (1/4th oct.)","60 bands (1/6th oct.)","80 bands (1/8th oct.)","120 bands (1/12th oct.)","240 bands (1/24th oct.)"][+t||0]:e==Ot?0==t?"None":1==t?"Legacy":(100*t|0)+"%":e==jt?0==t?0:(100*t|0)+"%":e==ja?0==t?"OFF":a(t)+" RPM"+(-1==n(t)?" (CCW)":""):t})(e.value))}!async function(){const e=e=>{ls(!0)||(ss(0),_s("Queue ended",10),wo()&&oo.pause())},t=e=>{e.target.attributes.src&&Go("Error loading "+e.target.src,!0)},a=e=>{Wn[kn].attributes.src?(wo()&&oo.play(),Wn[kn].currentTime<.1&&"1"==wa.value&&vs(!0),Lo(Ra)&&_s(1,+Ja.value||1/0)):us(En)},i=e=>{if(e.target!=Wn[kn])return;const{currentTime:t,duration:a}=Wn[kn];qa.value=a&&a!=1/0?t/a:0,Ba.innerText=Io(t,!0),Fa.innerHTML=Io(a?t-a:0,!0).padEnd(6).replaceAll(" ","&nbsp;")};let l=!1;ps(pa,gn,"panel"),yn=Lt('label[for="panel-console"]'),window.addEventListener("error",(e=>Go(`Unexpected ${e.error}`,!0))),Go(`audioMotion v${R} initializing...`),Go(`User agent: ${navigator.userAgent}`),Lt("#version").innerText=R;const x=ts(Se),S=Lt("#update-banner");let E;null!=x&&x!=R||S.remove(),x!=R&&(Cs(Se,R),null!=x&&(S.classList.add(yt),S.addEventListener("click",(()=>S.classList.remove(yt))),setTimeout((()=>{S.classList.remove(yt)}),1e4)));try{E=await fetch(ft)}catch(e){}let C=E&&E.ok?await E.text():null;try{C=JSON.parse(C)}catch(e){Go(`Error parsing ${ft} - ${e}`,!0),C={}}C={...pt,...C},$n=C.enableLocalAccess&&!!window.showDirectoryPicker;const T="audiomotion.app"!=window.location.hostname,A=new URL(window.location).searchParams,I=A.get("mode"),P=A.get("mediaPanel");let D=C.enableLocalAccess&&(!T||I==fe||"server"!=I&&ts(ye));null===D&&(D=C.defaultAccessMode==fe),(P==Re||C.mediaPanel==Re&&P!=De)&&Ys(!1),Go(`Instantiating audioMotion-analyzer v${n.A.version}`),vn=new n.A(Ct,{bgAlpha:0,fsElement:Ft,onCanvasDraw:(e,t)=>{if(!Wn.length)return;const a=Wn[kn],n=a.dataset,o=a.duration-a.currentTime,s=+qt.value,r=At.value[0],i=Mt.value,l=Lo(ca),c=e.pixelRatio,{timestamp:d}=t;if(o<.1&&ls(!0),s>0&&o<=s&&Lo(Ra)&&d>Jn.endTime&&xo()&&_s(1,o,1),!(i!=V&&"4"!=i&&"5"!=i||r!=j&&r!=U)){let t;if(i==V)t=(70*e.getEnergy()|0)-25;else{const e=a.currentTime/a.duration;t=100*("4"==i?e:1-e)}Ft.style.backgroundSize=`auto ${100+t}%`}ua.width|=0;const{endTime:u,startTime:f,msgTimer:p,info:h,msg:m,fade:b}=Jn;if(d>u&&d>p)return;const g=(e,t,a,n)=>{l?(ao.strokeText(e,t,a,n),ao.fillText(e,t,a,n)):(ao.shadowOffsetX=ao.shadowOffsetY=3*c,ao.fillText(e,t,a,n),ao.shadowOffsetX=ao.shadowOffsetY=0)};if(ao.lineWidth=4*c,ao.lineJoin="round",ao.font=zn,ao.textAlign="center",ao.fillStyle="#fff",ao.strokeStyle=ao.shadowColor="#000",p>d&&(d>u||2!=h)){const e=(p-d)/1e3;ao.globalAlpha=e>1?1:e,g(Jn.msg,Rn,Hn)}if(u>d){if(b<0){const e=(u-d)/1e3;ao.globalAlpha=e>-b?1:e/-b}else{const e=Math.max(0,(d-f)/1e3);ao.globalAlpha=e>b?1:e/b}if(2==Jn.info&&(g(bo(),Rn,Hn,jn),ao.textAlign="left",g(co(sa),Mn,Hn,jn),g(`Randomize: ${co(wa)}`,Mn,Fn,jn),ao.textAlign="right",g(co(Oa).toUpperCase()+" sensitivity",Dn,Hn,jn),g(`Repeat is ${Co(Ea)}`,Dn,Fn,jn)),Na.checked)ao.textAlign="left",ao.font=Gn,g("MIC source",Mn,qn,Un);else{ao.textAlign="right",g(n.codec,Dn,Bn),g(n.quality,Dn,Bn+Mn);const e=Ao();e&&Ia.checked&&g(`Track ${En+1} of ${e}`,Dn,Bn-Mn),ao.textAlign="left",g(n.artist.toUpperCase(),Mn,Bn,Un),ao.font=`italic ${zn}`,g(n.album,Mn,Nn,Un),ao.font=Gn,g(a.src?n.title:"No song loaded",Mn,qn,Un),(a.duration||n.duration)&&(n.duration||(n.duration=Io(a.duration),Sn.children[En]&&(Sn.children[En].dataset.duration=n.duration)),ao.textAlign="right",g(Io(a.currentTime)+" / "+n.duration,Dn,Nn)),no.width&&Ma.checked&&ao.drawImage(no,Mn,Bn-1.3*Pn,Pn,Pn)}}},onCanvasResize:(e,t)=>{let a;switch(zo(t),e){case"create":Go(`Display resolution: ${t.fsWidth} x ${t.fsHeight} px (pixelRatio: ${window.devicePixelRatio})`),a="Canvas created";break;case"lores":a=`Lo-res ${t.loRes?"ON":"OFF"} (pixelRatio = ${t.dPR})`;break;case"fschange":a=(t.isFullscreen?"Enter":"Exit")+"ed fullscreen";break;case"user":a=(wo()?"Resized for":"Closed")+" PIP";break;default:return}Go(`${a||e}. Canvas size is ${t.canvas.width} x ${t.canvas.height} px`)}});const H=vn.audioCtx,F=function(){const e=(e,t)=>{Array.isArray(e)&&e.forEach((e=>{const{value:a,disabled:n}="object"==typeof e?e:{value:e,disabled:!0},o=Array.isArray(t)?t.find((e=>e.value==a)):t[a];o&&(o.disabled=n)}))},t=ts(xe),a=null!==t,n=ts(we)||{},{fftSize:o,smoothing:s}=n;((e,t)=>{const a=po(e);-1!=a&&(en[a].options=t)})(qe,{...ho(Be),fftSize:o,smoothing:s,...t}),_n=ts(me)||[],Array.isArray(_n)||(_n=[{name:"Custom",options:_n}]);for(let e=0;e<9;e++)void 0===_n[e]?_n[e]={}:yo(_n[e])||_n[e].options||(_n[e]={options:_n[e]});e(ts(be),ln);const r=ts(he);r&&Object.keys(r).forEach((e=>{tn[e]=r[e],tn[e].key=e})),e(ts(ge),tn),e(ts(ve),on);const i=St(".min-db");i.forEach((e=>Po(e,-120,-60)));const l=St(".max-db");l.forEach((e=>Po(e,-50,0)));const c=St(".linear-boost");return c.forEach((e=>Po(e,1,5,.2))),(ts($e)||sn).forEach(((e,t)=>{i[t].value=e.min,l[t].value=e.max,c[t].value=e.boost||sn[t].boost})),Ms({...rn,...ts(ke)||{}}),gs(ba,fn),Po(Gt,25,100,5),gs(aa,un),gs(Pt,[[G,"Disable"],[W,"Built-in"],[...$n?[K,"Local folder"]:[]]]),Po(Rt,0,1e3),gs(fa,[["0","Small"],["1","Medium"],["2","Large"]]),Ka.disabled=vn.audioCtx.destination.maxChannelCount<=2,Is({...dn,...n}),Po(Yt,.01,25,.01),Po(ha,0,5e3,50),Po(ma,0,5e3,50),Rs({...hn,...ts(Ee)||{}}),gs(za,[["none","None"],[ht,"Shadow"],["solid","Solid"]]),gs(Ga,[["gold","Gold"],["gray","Gray"],[mt,"White"],["yellow","Yellow"]]),gs(Wa,[["top","Top"],[kt,"Center"],[vt,"Bottom"]]),Bs({...bn,...ts(Ae)||{}}),a}();Sn=Lt("#playlist"),Sn.addEventListener("dblclick",(e=>{e.target&&e.target.dataset.file&&(us(lo(e.target)),e.target.classList.remove("selected","sortable-chosen"))})),En=0,O.Ay.create(Sn,{animation:150,group:{name:"filelist",pull:!1,put:!0},multiDrag:!0,multiDragKey:"ctrl",selectedClass:"selected",onEnd:e=>{En=lo(Sn.querySelector(".current")),0!=e.newIndex||xo()?ss(B):ss(0),Ws(!0)}}),kn=0,Ln=1;for(const n of[0,1])Wn[n]=Lt(`#player${n}`),Uo(n),Wn[n].addEventListener("play",a),Wn[n].addEventListener("ended",e),Wn[n].addEventListener("error",t),Wn[n].addEventListener("timeupdate",i),Wn[n].querySelector("track").addEventListener("load",qs),vn.connectInput(Wn[n]);Po(qa,0,1,.001),qa.value=0,Ba.innerText=Fa.innerText=Io(0,!0),function(){const e=e=>+e.value>=+e.min&&+e.value<=+e.max;var t,a,n,o,s;t=Lt("#enabled_bgfit"),a="enabledBgFit",o=Mt,s=be,(n=ln).forEach((e=>{t.innerHTML+=`<label><input type="checkbox" class="${a}" data-option="${e.value}" ${e.disabled?"":"checked"}> ${e.text}</label>`})),St(`.${a}`).forEach((e=>{e.addEventListener("click",(t=>{if(!e.checked&&n.filter((e=>!e.disabled)).length<2)return M().alert({text:"At least one item must be enabled!"}),t.preventDefault(),!1;const a=n.find((t=>t.value==e.dataset.option));a&&(a.disabled=!e.checked,gs(o,n),Es(s))}))}));const r=Lt("#enabled_gradients");Object.keys(tn).forEach((e=>{r.innerHTML+=`<label><input type="checkbox" class="enabledGradient" data-grad="${e}" ${tn[e].disabled?"":"checked"}> ${tn[e].name}</label>`})),hs();const i=Lt("#random_properties");on.forEach((e=>{i.innerHTML+=`<label${e.value==nt?' class="colspan-3"':""}><input type="checkbox" class="randomProperty" value="${e.value}" ${e.disabled?"":"checked"}> ${e.text}</label>`})),St(".randomProperty").forEach((e=>{e.addEventListener("click",(t=>{on.find((t=>t.value==e.value)).disabled=!e.checked,Es(ve)}))})),St("[data-preset]").forEach((t=>{"reset-sens"==t.className?t.addEventListener("click",(()=>{const e=t.dataset.preset;Lt(`.min-db[data-preset="${e}"]`).value=sn[e].min,Lt(`.max-db[data-preset="${e}"]`).value=sn[e].max,Lt(`.linear-boost[data-preset="${e}"]`).value=sn[e].boost,St(`[data-preset="${e}"]`).forEach((e=>{e.classList.remove("field-error")})),t.dataset.preset==uo(Oa)&&Ds(Oa,!1),Es($e)})):t.addEventListener("change",(()=>{e(t)&&(t.dataset.preset==uo(Oa)&&Ds(Oa,!1),Es($e)),t.classList.toggle("field-error",!e(t))}))}));for(const e of[Jt,Ja,qt,Ma,Ia])e.addEventListener("change",(()=>Es(ke)));Lt("#reset_osd").addEventListener("click",(()=>{Ms(rn),Es(ke)})),cn.forEach((t=>{t.addEventListener("change",(()=>{const a="number"!=t.type||e(t);a&&Ds(t),t.classList.toggle("field-error",!a)}))})),Lt("#reset_general").addEventListener("click",(()=>{Is(dn),Ds(cn)})),pn.forEach((t=>{t.addEventListener("change",(()=>{const a="number"!=t.type||e(t);a&&Ds(t),t.classList.toggle("field-error",!a)}))})),Lt("#reset_peak").addEventListener("click",(()=>{Rs(hn),Ds(pn)})),mn.forEach((e=>e.addEventListener("change",(()=>Ds(e))))),Lt("#reset_subs").addEventListener("click",(()=>{Bs(bn),Ds(mn)})),Ds(mn)}(),bs();for(const e of[16,20,25,30,40,50,60,100,250,500,1e3,2e3])La[La.options.length]=new Option((e>=1e3?e/1e3+"k":e)+"Hz",e);for(const e of[1e3,2e3,4e3,8e3,12e3,16e3,2e4,22e3])xa[xa.options.length]=new Option(e/1e3+"kHz",e);ps(sa,an),ps(Dt,nn),ps(Oa,[["0","Low"],["1","Medium"],["2","High"]]),gs(wa,[["0","OFF"],["1","On track change"],["2","every 5 seconds"],["6","every 15 seconds"],["12","every 30 seconds"],["24","every minute"],["48","every 2 minutes"],["120","every 5 minutes"]]),ps(Sa,[[je,"Off"],[Ge,"25%"],[Ue,"40%"],[ze,"Mirror"]]),gs(Mt,ln),ps(oa,[["-1","Left"],["0","Off"],["1","Right"]]),ps(zt,[[lt,"Bark"],["linear","Linear"],[ct,"Log"],["mel","Mel"]]),ps(Qa,[["","Off"],["A","A"],["B","B"],["C","C"],[wt,"D"],["468","468"]]),ps(Ht,[[oe,"Gradient"],[se,"Index"],[re,"Level"]]),ps(Pa,[[He,"Off"],[1,"Drop"],[Fe,"Fade"]]),ps(Aa,[[dt,"Off"],[1,"Freqs"],[ut,"Notes"]]),ps(_a,[[dt,"Off"],[1,"On"]]),ps(Tt,[[0,"Tempered"],[1,"ANSI/IEC"]]),ps(Vt,[[0,"Decibels"],[1,"Linear"]]);let q=[];for(let e=10;e<16;e++){const t=2**e;q.push([t,(t/1024|0)+"k"])}ps(Nt,q),Po(_t,1,8),Po(Ot,0,1,.05),Po(It,.1,1,.05),Po(jt,0,1,.05),Po(Zt,0,3,.5),Po(ya,0,1,.05),Po(Ha,0,.95,.05),Po(ja,-10,10,1),_s(),Object.keys(tn).forEach((e=>{const{bgColor:t,dir:a,colorStops:n}=tn[e];n&&vn.registerGradient(e,{bgColor:t,dir:a,colorStops:n})})),ms();const N=function(e,t={}){let a;var n;return f=document.createElement("ul"),f.className="breadcrumb",e.append(f),p=document.createElement("ul"),p.className="filelist",e.append(p),a=setTimeout((()=>{f.innerHTML="Waiting for server..."}),5e3),f.innerHTML="Initializing... please wait...",f.addEventListener("click",(async function(e){e.target&&"LI"==e.target.nodeName&&function(e){let t;for(;e>0;)t=h.pop(),e--;const a=h[h.length-1];a&&a.handle&&(c=a.handle,t=null),w(t,t&&t.scrollTop)}(e.target.dataset.depth)})),p.addEventListener("click",(async function(e){const t=e.target;if(t&&"LI"==t.nodeName)if("dir"==t.dataset.type)w(t.handle||t.dataset.path);else if("mount"==t.dataset.type)if(v)try{c=await window.showDirectoryPicker({startIn:"music"}),h=[],w(c)}catch(e){}else h=[],w(t.dataset.path)})),p.addEventListener("dblclick",(function(e){const t=e.target;t&&"LI"==t.nodeName&&d&&["file","list"].includes(t.dataset.type)&&d({file:L(t.dataset.path),handle:t.handle,dirHandle:t.dirHandle,subs:t.subs},e)})),"function"==typeof t.onDblClick&&(d=t.onDblClick),"function"==typeof t.onEnterDir&&(u=t.onEnterDir),t.fileExtensions&&(n=t.fileExtensions,m=new RegExp("\\.("+n.join("|")+")$","i")),new Promise((e=>{fetch(".",{method:"HEAD"}).then((async n=>{clearTimeout(a),k=!0,b=[t.rootPath||o],g=await w(b[0]),(t.forceFileSystemAPI&&s||!g)&&(h=[],s?(b=[r],v=!0):b=[],y()),e({webServer:k,useFileSystemAPI:v,serverHasMedia:g,filelist:p})})).catch((t=>{clearTimeout(a),s?(b=[r],v=!0):b=[],y(),e({webServer:k,useFileSystemAPI:v,filelist:p})}))}))}(Lt("#file_explorer"),{onDblClick:(e,t)=>{Ho([e],!0),t.target.classList.remove("selected","sortable-chosen")},onEnterDir:e=>{Ta.checked&&l&&Oo(e)},fileExtensions:[...le,...de,...ue],forceFileSystemAPI:D}).then((e=>{In=e.webServer,Tn=e.serverHasMedia,An=e.useFileSystemAPI;const{filelist:t}=e;Tn||Go(In?"Cannot access music directory on server":"No server found",!0),An&&Go("Accessing files from local device via File System Access API."),!$n&&C.enableLocalAccess&&Go('No browser support for File System Access API. Cannot access files from local device. <a href="https://audiomotion.app/docs/#/known-issues?id=file-system-access-api" target="_blank">Learn more...</a>',D),Cs(ye,D&&$n),os(),(An||Tn)&&O.Ay.create(t,{animation:150,draggable:'[data-type="file"], [data-type="list"]',group:{name:"filelist",pull:"clone",put:!1},multiDrag:!0,multiDragKey:"ctrl",selectedClass:"selected",sort:!1,onEnd:e=>{if("playlist"==e.to.id){let t=e.items.length?e.items:[e.item],a=[];t.forEach((e=>{const{handle:t,dirHandle:n,subs:o}=e;a.push(qo({file:L(e.dataset.path),handle:t,dirHandle:n,subs:o})),e.remove()})),Promise.all(a).then((()=>Ws(!0)))}}}),js()}));window.addEventListener("keydown",Zo),window.addEventListener("keyup",Zo),M().setOptions({positions:{alert:"bottom"}}),Promise.all([ws(),N]).then((async()=>{const e=()=>{a&&$(a),$a.checked&&as({file:!0})},t=async()=>{!(o&&"granted"!=await n.requestPermission()||s&&"granted"!=await a[0].handle.requestPermission())&&(na.classList.remove("locked"),window.removeEventListener("click",t),o&&ws(),e())},a=An?await(0,_.Jt)(Le):ts(Le),n=await(0,_.Jt)(pe),o=$n&&n&&"granted"!=await n.queryPermission(),s=An&&Array.isArray(a)&&a[0]&&"granted"!=await a[0].handle.queryPermission();Go(`Loading ${F?"last session":"default"} settings`),ns(qe,!1,!0),o||s?(na.classList.add("locked"),window.addEventListener("click",t)):e(),Ds(Ka),Go(`AudioContext sample rate is ${H.sampleRate}Hz; Total latency is ${1e3*((H.outputLatency||0)+H.baseLatency)|0}ms`),Go("Initialization complete!"),l=!0}))}()},6216:()=>{Element.prototype.scrollIntoViewIfNeeded||(Element.prototype.scrollIntoViewIfNeeded=function(e){e=0===arguments.length||!!e;var t=this.parentNode,a=window.getComputedStyle(t,null),n=parseInt(a.getPropertyValue("border-top-width")),o=parseInt(a.getPropertyValue("border-left-width")),s=this.offsetTop-t.offsetTop<t.scrollTop,r=this.offsetTop-t.offsetTop+this.clientHeight-n>t.scrollTop+t.clientHeight,i=this.offsetLeft-t.offsetLeft<t.scrollLeft,l=this.offsetLeft-t.offsetLeft+this.clientWidth-o>t.scrollLeft+t.clientWidth,c=s&&!r;(s||r)&&e&&(t.scrollTop=this.offsetTop-t.offsetTop-t.clientHeight/2-n+this.clientHeight/2),(i||l)&&e&&(t.scrollLeft=this.offsetLeft-t.offsetLeft-t.clientWidth/2-o+this.clientWidth/2),(s||r||i||l)&&!e&&this.scrollIntoView(c)})},143:()=>{},3411:()=>{}},a={};function n(e){var o=a[e];if(void 0!==o)return o.exports;var s=a[e]={exports:{}};return t[e].call(s.exports,s,s.exports,n),s.exports}n.m=t,e=[],n.O=(t,a,o,s)=>{if(!a){var r=1/0;for(d=0;d<e.length;d++){for(var[a,o,s]=e[d],i=!0,l=0;l<a.length;l++)(!1&s||r>=s)&&Object.keys(n.O).every((e=>n.O[e](a[l])))?a.splice(l--,1):(i=!1,s<r&&(r=s));if(i){e.splice(d--,1);var c=o();void 0!==c&&(t=c)}}return t}s=s||0;for(var d=e.length;d>0&&e[d-1][2]>s;d--)e[d]=e[d-1];e[d]=[a,o,s]},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={792:0};n.O.j=t=>0===e[t];var t=(t,a)=>{var o,s,[r,i,l]=a,c=0;if(r.some((t=>0!==e[t]))){for(o in i)n.o(i,o)&&(n.m[o]=i[o]);if(l)var d=l(n)}for(t&&t(a);c<r.length;c++)s=r[c],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return n.O(d)},a=self.webpackChunkaudioMotion=self.webpackChunkaudioMotion||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var o=n.O(void 0,[96],(()=>n(6965)));o=n.O(o)})();