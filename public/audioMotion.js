/*! For license information please see audioMotion.js.LICENSE.txt */
(()=>{var e,t={6965:(e,t,a)=>{"use strict";var n=a(4015);const s="/music",o="electron"in window,i=o&&/Windows/.test(navigator.userAgent),l=!!window.showDirectoryPicker,r="Click to open a new root folder",c="No music found on server and no browser support for File System API",d="loading",u=0;let f,h,p,m,b,g,v=[],k=/.*/,y=[],w=!1,x=!1,L=!1;function S(e,t){m.innerHTML="",b.innerHTML="",b.style.backgroundImage="";const a=(e,t)=>{const a=document.createElement("li"),n=e.name||e;a.dataset.type=null!==n.match(/\.(m3u|m3u8)$/)&&"file"==t?"list":t,a.dataset.path=n,a.dataset.subs=+!!e.subs,a.innerText=n,a.handle=e.handle,a.subs=e.subs,b.append(a)},n=e=>b.style.backgroundImage="linear-gradient( #fff9 0%, #fff9 100% )"+(e?`, url('${e}')`:"");if(0==y.length&&(m.innerHTML=c),v.forEach((({dir:e},t)=>{m.innerHTML+=`<li data-depth="${v.length-t-1}">${e}</li> ${i?"\\":"/"==e?"":"/"} `})),y.forEach((e=>{b.innerHTML+=`<li data-type="mount" ${L&&!f?'class="full-panel"':""} data-path="${e}">[ ${e} ]</li>`})),v.length>1&&(b.innerHTML+='<li data-type="dir" data-path="..">[ parent folder ]</li>'),e){const{cover:t,dirs:s,files:o}=e;s&&s.forEach((e=>a(e,"dir"))),o&&o.forEach((e=>a(e,"file"))),t&&t.handle?t.handle.getFile().then((e=>n(URL.createObjectURL(e)))):n(t?$(t):"")}b.scrollTop=t||0}function E(e,t){let a,n=e&&"string"!=typeof e?e:null,s=f,o=[...v];if(n&&(e=n.name),e)if(".."==e){a=v.pop();const e=v[v.length-1];e&&e.handle&&(n=e.handle)}else v.push({dir:e,scrollTop:b.scrollTop,handle:n});return b.classList.add(d),new Promise((async e=>{const i=n=>{b.classList.remove(d),!1!==n?(w&&!L||(n=_(n)),S(n,t||a&&a.scrollTop),p&&p(v),e(!0)):(v=o,f=s,e(!1))};if(f){n&&(f=n);let e=[];try{for await(const t of f.entries())e.push(t)}catch(t){e=!1}i(e)}else{const e=$();fetch(e).then((e=>200==e.status&&(w?e.json():e.text()))).then((e=>i(e))).catch((()=>i(!1)))}}))}function T(e){return e.replace(/[#%&]/g,(e=>({"#":"%23","%":"%25","&":"%26"}[e])))}function $(e,t){let a="";return v.forEach((({dir:e})=>{a+=e+("/"==e?"":"/")})),e&&(a+=e),a=T(a),o?(a=a.replace(/\//g,"%2f"),t||(a=(e?"/getFile/":"/getDir/")+a)):g==u&&"/"==a[0]&&(a=a.slice(1)),a}function C(e="li"){let t=[];return b.querySelectorAll(e).forEach((e=>{const{handle:a,subs:n}=e,{path:s,type:o}=e.dataset;["file","list"].includes(o)&&t.push({file:$(s),handle:a,subs:n,type:o})})),t}async function A(e){const t=[...v],a=e.split("/");let n=t[t.length-1].handle;for(;a.length>1;){const e=a.shift();if(".."==e)t.pop(),n=t[t.length-1].handle;else{try{n=await n.getDirectoryHandle(e)}catch(e){return{}}t.push({handle:n})}}let s,o=a.shift(),i=o.slice(0,o.lastIndexOf("."));try{s={handle:await n.getFileHandle(i+".vtt")}}catch(e){}try{n=await n.getFileHandle(o)}catch(e){n=void 0}return{handle:n,subs:s}}function P(e){const t=e.match(/href="[^"]*"[^>]*>[^<]*<\/a>/gi);let a=[];for(const e of t){const t=e.match(/href="([^"]*)"[^>]*>\s*([^<]*)<\/a>/i)[1],n="/"==t.slice(-1),s=t.slice(t.lastIndexOf("/",n?t.length-2:void 0)+1),o=decodeURIComponent(s.slice(0,n?-1:void 0));a.push({url:s,file:o})}return a}function _(e){const t=/\.(jpg|jpeg|webp|avif|png|gif|bmp)$/i,a=/\.vtt$/i;let n=[],s=[],o=[],i=[];const l=(e,a)=>{const n=new RegExp(`${a}.*${t.source}`,"i");return e.find((e=>(e.name||e).match(n)))};if(L)for(const[l,r]of e){const e={name:l,handle:r};r instanceof FileSystemDirectoryHandle?n.push(e):r instanceof FileSystemFileHandle&&(l.match(t)?o.push(e):l.match(a)&&i.push(e),l.match(k)&&s.push(e))}else for(const{url:l,file:r}of P(e)){const e={name:r};"/"==l.slice(-1)?r.match(/(parent directory|\.\.)/i)||n.push(e):(r.match(t)?o.push(e):r.match(a)&&i.push(e),r.match(k)&&s.push(e))}for(const e of i){const{name:t,handle:a}=e,[,n,,o]=t.match(/(.*?)(\.([a-z]{0,3}))?\.vtt$/i)||[],i=s.find((e=>e.name.startsWith(n)));i&&(i.subs={src:$(t),lang:o,handle:a})}const r=(e,t)=>(new Intl.Collator).compare(e.name,t.name);return{cover:l(o,"cover")||l(o,"folder")||l(o,"front")||o[0],dirs:n.sort(r),files:s.sort(r)}}async function O(e){const t=e&&e[e.length-1],a=f,n=[...v];v=e,t&&t.handle&&(f=t.handle);const s=!!e&&await E();return s||(f=a,v=n,L||v.length?L&&!f&&S():E(y[0])),s}var I=a(6015),M=(a(6216),a(7783)),R=a(246),D=a(4596),F=a.n(D);R.Ay.mount(new R.cR);const B="electron"in window,q=B&&/Windows/.test(navigator.userAgent),H="/getFile/",N="/getCover/",j="/savePlist/",U=location.origin+location.pathname,z="24.6",W=B?"/getBackground":"backgrounds",G=4,K=2e3,Y="0",V="1",X="2",J="3",Z="4",Q="0",ee="1",te="2",ae="0",ne="1",se="2",oe="3",ie="6",le="7",re="8",ce={album:"",artist:"",codec:"",cover:"",duration:"",file:"",quality:"",title:""},de="dual-combined",ue="single",fe="gradient",he="bar-index",pe="bar-level",me=20,be=["mp3","flac","m4a","aac","ogg","wav"],ge=["jpg","jpeg","webp","avif","png","gif","bmp"],ve=["m3u","m3u8"],ke=["mkv","mpg","webm","mp4","avi","mov"],ye="local",we="bgDir",xe="custom-grads",Le="custom-preset",Se="disabled-bgfit",Ee="disabled-gradients",Te="disabled-modes",$e="disabled-properties",Ce="display-options",Ae="force-filesystem",Pe="general-settings",_e="last-config",Oe="last-dir",Ie="last-version",Me="peak-settings",Re="playlists",De="playqueue",Fe="sensitivity-presets",Be="subtitles-settings",qe="pl_",He="10",Ne="101",je="close",Ue="open",ze="No description",We="1",Ge="2",Ke="alpha",Ye="nobg",Ve="barSp",Xe="imgfit",Je="stereo",Ze="colormode",Qe="fill",et="gradient",tt="leds",at="line",nt="lumi",st="mirror",ot="mode",it="outline",lt="peaks",rt="presets",ct="radial",dt="spin",ut="reflex",ft="round",ht="split",pt="bark",mt="log",bt=1,gt=-1,vt="config.json",kt={defaultAccessMode:ye,enableLocalAccess:!0,mediaPanel:Ue},yt="shadow",wt="white",xt="subs-bg-",Lt="subs-color-",St="bottom",Et="center",Tt="show",$t="D",Ct=832,At=document.querySelector.bind(document),Pt=document.querySelectorAll.bind(document),_t=At("#alpha_bars"),Ot=At("#analyzer"),It=At("#ansi_bands"),Mt=At("#auto_hide"),Rt=At("#background"),Dt=At("#balance"),Ft=At("#bar_space"),Bt=At("#bg_img_dim"),qt=At("#bg_img_fit"),Ht=At("#bg_location"),Nt=At("#bg_max_items"),jt=At("#channel_layout"),Ut=At("#color_mode"),zt=At("#bg_container"),Wt=At("#bg_dim"),Gt=At("#end_timeout"),Kt=At("#fade_peaks"),Yt=At("#fft_size"),Vt=At("#fill_alpha"),Xt=At("#fps"),Jt=At("#freq_scale"),Zt=At("#fs_height"),Qt=At("#gradient"),ea=At("#gradientRight"),ta=At("#gravity"),aa=At("#info_timeout"),na=At("#led_display"),sa=At("#linear_amplitude"),oa=At("#line_width"),ia=At("#link_grads"),la=At("#loaded_playlist"),ra=At("#lo_res"),ca=At("#lumi_bars"),da=At("#max_fps"),ua=At("#files_panel"),fa=At("#mirror"),ha=At("#mode"),pa=At("#mute"),ma=At("#no_dim_subs"),ba=At("#no_dim_video"),ga=At("#no_shadow"),va=At("#note_labels"),ka=At("#outline"),ya=At("#osd"),wa=At("#osd_font_size"),xa=At("#peak_fade"),La=At("#peak_hold"),Sa=At("#pip_ratio"),Ea=At("#playlists"),Ta=At("#radial"),$a=At("#random_mode"),Ca=At("#freq_max"),Aa=At("#freq_min"),Pa=At("#reflex"),_a=At("#repeat"),Oa=At("#round_bars"),Ia=At("#save_dir"),Ma=At("#save_queue"),Ra=At("#scaleX"),Da=At("#scaleY"),Fa=At("#sensitivity"),Ba=At("#show_count"),qa=At("#show_cover"),Ha=At("#show_peaks"),Na=At("#show_song"),ja=At("#show_subs"),Ua=At("#smoothing"),za=At("#song_duration"),Wa=At("#current_time"),Ga=At("#progress"),Ka=At("#source"),Ya=At("#spin"),Va=At("#split_grad"),Xa=At("#subs_background"),Ja=At("#subs_color"),Za=At("#subs_position"),Qa=At("#toggle_console"),en=At("#toggle_settings"),tn=At("#track_timeout"),an=At("#video"),nn=At("#volume"),sn=At("#warp"),on=At("#weighting"),ln=[{key:"demo",name:"Demo (random)",options:{randomMode:6}},{key:"bands",name:"Octave Bands",options:{alphaBars:0,ansiBands:0,background:X,barSpace:.25,bgImageDim:.3,bgImageFit:ae,channelLayout:ue,colorMode:fe,freqMax:2e4,freqMin:25,freqScale:mt,gradient:"rainbow",ledDisplay:0,linearAmpl:1,lumiBars:0,mirror:0,mode:"2",noteLabels:1,outlineBars:0,radial:0,randomMode:0,reflex:We,roundBars:0,showPeaks:1,showScaleX:1,showScaleY:0,showSong:1,splitGrad:0,weighting:$t}},{key:"ledbars",name:"Classic LED bars",options:{alphaBars:0,ansiBands:1,background:X,barSpace:.25,bgImageDim:.3,bgImageFit:ne,channelLayout:ue,colorMode:fe,freqMax:2e4,freqMin:25,freqScale:mt,gradient:"classic",ledDisplay:1,linearAmpl:1,lumiBars:0,outlineBars:0,mirror:0,mode:"6",noteLabels:0,radial:0,randomMode:0,reflex:"0",roundBars:0,showPeaks:1,showScaleX:1,showScaleY:0,showSong:1,splitGrad:0,weighting:$t}},{key:"dual",name:"Dual-channel combined Graph, Bark frequency scale",options:{ansiBands:0,background:X,bgImageDim:.3,bgImageFit:ne,channelLayout:de,colorMode:fe,fillAlpha:.3,freqMax:2e4,freqMin:20,freqScale:pt,gradient:"cool",gradientRight:"dusk",linearAmpl:1,lineWidth:1.5,linkGrads:0,mirror:0,mode:Ne,noteLabels:0,radial:0,randomMode:0,reflex:"0",showPeaks:0,showScaleX:0,showScaleY:0,showSong:1,splitGrad:0,weighting:$t}},{key:"radial",name:"Radial Color by Level",options:{alphaBars:1,ansiBands:0,background:X,barSpace:.1,bgImageDim:.3,bgImageFit:oe,channelLayout:ue,colorMode:pe,freqMax:2e4,freqMin:20,freqScale:mt,gradient:"prism",ledDisplay:0,linearAmpl:1,lumiBars:0,mirror:0,mode:"5",noteLabels:0,outlineBars:0,radial:1,randomMode:0,showPeaks:1,showScaleX:1,showScaleY:0,showSong:1,spin:1,splitGrad:0,weighting:$t}},{key:"round",name:"Round Bars reflex",options:{alphaBars:0,background:X,barSpace:.25,bgImageDim:.3,bgImageFit:le,channelLayout:ue,colorMode:he,freqMax:2e4,freqMin:20,freqScale:mt,gradient:"apple",ledDisplay:0,linearAmpl:1,lumiBars:0,mirror:0,mode:"3",noteLabels:0,outlineBars:0,radial:0,randomMode:0,reflex:Ge,roundBars:1,showPeaks:0,showScaleX:0,showScaleY:0,showSong:1,splitGrad:0,weighting:$t}},{key:"last",name:"Last session",options:{}},{key:"default",name:"Restore defaults",options:{alphaBars:0,ansiBands:0,background:Y,balance:0,barSpace:.1,bgImageDim:.5,bgImageFit:ne,channelLayout:ue,colorMode:fe,fadePeaks:0,fillAlpha:.1,freqMax:2e4,freqMin:20,freqScale:mt,gradient:"prism",gradientRight:"prism",ledDisplay:0,linearAmpl:0,lineWidth:2,linkGrads:0,loRes:0,lumiBars:0,micSource:0,mirror:0,mode:"0",mute:0,noShadow:1,noteLabels:0,outlineBars:0,radial:0,randomMode:0,reflex:"0",repeat:0,roundBars:0,sensitivity:1,showFPS:0,showPeaks:1,showScaleX:1,showScaleY:0,showSong:1,showSubtitles:1,spin:2,splitGrad:0,volume:1,weighting:""}}],rn={apple:{name:"Apple ][",colorStops:[{pos:.1667,color:"#61bb46"},{pos:.3333,color:"#fdb827"},{pos:.5,color:"#f5821f"},{pos:.6667,color:"#e03a3e"},{pos:.8333,color:"#963d97"},{pos:1,color:"#009ddc"}],disabled:!1},aurora:{name:"Aurora",bgColor:"#0e172a",colorStops:[{pos:.1,color:"hsl( 120, 100%, 50% )"},{pos:1,color:"hsl( 216, 100%, 50% )"}],disabled:!1},borealis:{name:"Borealis",bgColor:"#0d1526",colorStops:[{pos:.1,color:"hsl( 120, 100%, 50% )"},{pos:.5,color:"hsl( 189, 100%, 40% )"},{pos:1,color:"hsl( 290, 60%, 40% )"}],disabled:!1},candy:{name:"Candy",bgColor:"#0d0619",colorStops:[{pos:.1,color:"#ffaf7b"},{pos:.5,color:"#d76d77"},{pos:1,color:"#3a1c71"}],disabled:!1},classic:{name:"Classic",disabled:!1},cool:{name:"Cool",bgColor:"#0b202b",colorStops:["hsl( 208, 0%, 100% )","hsl( 208, 100%, 35% )"],disabled:!1},dusk:{name:"Dusk",bgColor:"#0e172a",colorStops:[{pos:.2,color:"hsl( 55, 100%, 50% )"},{pos:1,color:"hsl( 16, 100%, 50% )"}],disabled:!1},miami:{name:"Miami",bgColor:"#110a11",colorStops:[{pos:.024,color:"rgb( 251, 198, 6 )"},{pos:.283,color:"rgb( 224, 82, 95 )"},{pos:.462,color:"rgb( 194, 78, 154 )"},{pos:.794,color:"rgb( 32, 173, 190 )"},{pos:1,color:"rgb( 22, 158, 95 )"}],disabled:!1},orient:{name:"Orient",bgColor:"#100",colorStops:[{pos:.1,color:"#f00"},{pos:1,color:"#600"}],disabled:!1},outrun:{name:"Outrun",bgColor:"#101",colorStops:[{pos:0,color:"rgb( 255, 223, 67 )"},{pos:.182,color:"rgb( 250, 84, 118 )"},{pos:.364,color:"rgb( 198, 59, 243 )"},{pos:.525,color:"rgb( 133, 80, 255 )"},{pos:.688,color:"rgb( 74, 104, 247 )"},{pos:1,color:"rgb( 35, 210, 255 )"}],disabled:!1},pacific:{name:"Pacific Dream",bgColor:"#051319",colorStops:[{pos:.1,color:"#34e89e"},{pos:1,color:"#0f3443"}],disabled:!1},prism:{name:"Prism",disabled:!1},prism_old:{name:"Prism (legacy)",colorStops:["hsl( 0, 100%, 50% )","hsl( 60, 100%, 50% )","hsl( 120, 100%, 50% )","hsl( 180, 100%, 50% )","hsl( 240, 100%, 50% )"],disabled:!0},rainbow:{name:"Rainbow",disabled:!1},rainbow_old:{name:"Rainbow (legacy)",dir:"h",colorStops:["hsl( 0, 100%, 50% )","hsl( 60, 100%, 50% )","hsl( 120, 100%, 50% )","hsl( 180, 100%, 47% )","hsl( 240, 100%, 58% )","hsl( 300, 100%, 50% )","hsl( 360, 100%, 50% )"],disabled:!0},shahabi:{name:"Shahabi",bgColor:"#060613",colorStops:[{pos:.1,color:"#66ff00"},{pos:1,color:"#a80077"}],disabled:!1},summer:{name:"Summer",bgColor:"#041919",colorStops:[{pos:.1,color:"#fdbb2d"},{pos:1,color:"#22c1c3"}],disabled:!1},sunset:{name:"Sunset",bgColor:"#021119",colorStops:[{pos:.1,color:"#f56217"},{pos:1,color:"#0b486b"}],disabled:!1},tiedye:{name:"Tie Dye",colorStops:[{pos:.038,color:"rgb( 15, 209, 165 )"},{pos:.208,color:"rgb( 15, 157, 209 )"},{pos:.519,color:"rgb( 133, 13, 230 )"},{pos:.731,color:"rgb( 230, 13, 202 )"},{pos:.941,color:"rgb( 242, 180, 107 )"}],disabled:!1}},cn=[{value:"0",text:"Discrete frequencies",disabled:!1},{value:He,text:"Area graph",disabled:!1},{value:Ne,text:"Line graph",disabled:!1},{value:"8",text:"Octave bands / 10 bands",disabled:!1},{value:"7",text:"1/2 octave / 20 bands",disabled:!1},{value:"6",text:"1/3 octave / 30 bands",disabled:!1},{value:"5",text:"1/4 octave / 40 bands",disabled:!1},{value:"4",text:"1/6 octave / 60 bands",disabled:!1},{value:"3",text:"1/8 octave / 80 bands",disabled:!1},{value:"2",text:"1/12 octave / 120 bands",disabled:!1},{value:"1",text:"1/24 octave / 240 bands",disabled:!1}],dn=[[ue,"Singl"],[de,"Comb"],["dual-horizontal","Horiz"],["dual-vertical","Vert"]],un=[{value:Ke,text:"Alpha",disabled:!1},{value:ot,text:"Analyzer Mode",disabled:!1},{value:Ye,text:"Background",disabled:!1},{value:Ve,text:"Bar Spacing",disabled:!1},{value:Xe,text:"BG Image Fit",disabled:!1},{value:Je,text:"Channel Layout",disabled:!1},{value:Ze,text:"Color Mode",disabled:!1},{value:Qe,text:"Fill Opacity",disabled:!1},{value:et,text:"Gradients",disabled:!1},{value:tt,text:"LEDs",disabled:!1},{value:at,text:"Line Width",disabled:!1},{value:nt,text:"Lumi",disabled:!1},{value:st,text:"Mirror",disabled:!1},{value:it,text:"Outline",disabled:!1},{value:lt,text:"Peaks",disabled:!1},{value:ct,text:"Radial",disabled:!1},{value:dt,text:"Radial Spin",disabled:!1},{value:ut,text:"Reflex",disabled:!1},{value:ft,text:"Round",disabled:!1},{value:ht,text:"Split",disabled:!1},{value:rt,text:"User Presets",disabled:!0}],fn=[{min:-70,max:-20,boost:1},{min:-85,max:-25,boost:1.6},{min:-100,max:-30,boost:2.4}],hn={info:5,track:10,end:10,covers:!0,count:!0},pn=[{value:ae,text:"Adjust",disabled:!1},{value:ne,text:"Center",disabled:!1},{value:oe,text:"Pulse",disabled:!1},{value:se,text:"Repeat",disabled:!1},{value:ie,text:"Warp",disabled:!1},{value:le,text:"Warp Drive",disabled:!1},{value:re,text:"Wormhole",disabled:!1},{value:"4",text:"Zoom In",disabled:!1},{value:"5",text:"Zoom Out",disabled:!1}],mn=[Mt,Ht,Nt,Yt,Zt,da,ma,ba,wa,Sa,Ia,Ma,Ua],bn={autoHide:!0,bgLocation:ee,bgMaxItems:20,fftSize:8192,osdFontSize:"1",fsHeight:100,maxFPS:60,noDimVideo:!0,noDimSubs:!0,pipRatio:2.35,saveDir:!0,saveQueue:!0,smoothing:.7},gn=[[30,"30"],[60,"60"],[0,"unlimited"]],vn=[[1,"1:1"],[1.33,"4:3"],[1.78,"16:9"],[2.35,"2.35:1"],[3.55,"32:9"]],kn=[ta,xa,La],yn={gravity:3.8,peakFade:750,peakHold:500},wn=[Xa,Ja,Za],xn={background:yt,color:wt,position:"top"};let Ln,Sn,En,Tn,$n,Cn,An,Pn,_n,On,In,Mn,Rn,Dn,Fn,Bn,qn,Hn,Nn,jn,Un,zn,Wn,Gn,Kn,Yn,Vn,Xn,Jn,Zn=[],Qn=[],es=[],ts=null,as={},ns=!1,ss=!1,os=!1,is=0;const ls=ya.getContext("2d"),rs=new Image,cs=document.createElement("video"),ds=(e,t)=>e.replace(/(%2f|\/)/g,t&&q?"\\":"/"),us=e=>e.replace(/\//g,"%2f"),fs=e=>Math.round(100*e)/100,hs=e=>{if(!e)return;let t=0;for(;e=e.previousElementSibling;)t++;return t},ps=e=>{let t="";if(Ls(e)){const a=e.querySelector(":checked ~ label");a&&(t=a.textContent)}else t=e[e.selectedIndex].text;return t},ms=e=>Ls(e)?e.elements[e.dataset.prop].value:void 0!==e.dataset.active?e.dataset.active:e.value,bs=e=>({alphaBars:ms(_t),ansiBands:ms(It),background:ms(Rt),barSpace:ms(Ft),bgImageDim:ms(Bt),bgImageFit:ms(qt),channelLayout:ms(jt),colorMode:ms(Ut),fadePeaks:ms(Kt),fillAlpha:ms(Vt),freqMax:ms(Ca),freqMin:ms(Aa),freqScale:ms(Jt),gradient:ms(Qt),gradientRight:ms(ea),ledDisplay:ms(na),linearAmpl:ms(sa),lineWidth:ms(oa),linkGrads:ms(ia),loRes:ms(ra),lumiBars:ms(ca),mirror:ms(fa),mode:ms(ha),noShadow:ms(ga),noteLabels:ms(va),outlineBars:ms(ka),radial:ms(Ta),randomMode:ms($a),reflex:ms(Pa),repeat:ms(_a),roundBars:ms(Oa),sensitivity:ms(Fa),showFPS:ms(Xt),showPeaks:ms(Ha),showScaleX:ms(Ra),showScaleY:ms(Da),showSong:ms(Na),showSubtitles:ms(ja),spin:ms(Ya),splitGrad:ms(Va),weighting:ms(on)}),gs=e=>{const t=+e==e?e:ln.findIndex((t=>t.key==e));return t<0||t>ln.length-1?-1:t},vs=e=>{const t=gs(e);return-1==t?{}:ln[t].options},ks=e=>{const t=gs(e);return-1!=t&&ln[t].name},ys=()=>{const e=ms(jt)!=ue&&!Cs(ia);return`Gradient${e?"s":""}: ${rn[Qt.value].name+(e?" / "+rn[ea.value].name:"")}`},ws=()=>Fn.map(((e,t)=>`<strong>[${t+1}]</strong>&nbsp; ${Es(e)?'<em class="empty">Empty slot</em>':e.name||ze}`)),xs=e=>e&&e.startsWith("blob:"),Ls=e=>"FORM"==e.tagName&&null!=e.dataset.prop,Ss=e=>e.startsWith("http")&&!e.startsWith(U),Es=e=>!e||"object"!=typeof e||!Object.keys(e).length,Ts=e=>zt.classList.contains("pip"),$s=(e=Zn[En])=>e&&e.currentTime>0&&!e.paused&&!e.ended,Cs=e=>"1"==e.dataset.active,As=()=>ke.includes(Os(Zn[En].dataset.file).extension),Ps=e=>"string"==typeof e?e.replace(/\\/g,"/"):e,_s=e=>Cs(e)?"ON":"OFF",Os=e=>{if("string"!=typeof e)return{};const t=Fs(e),a=t.lastIndexOf("/")+1,n=t.slice(0,a),s=t.slice(a),o=s.lastIndexOf("."),i=o>=0?s.slice(0,o):s,l=o>=0?s.slice(o+1).toLowerCase():"";return{path:n,fileName:s,baseName:i,extension:l}},Is=e=>{const t=/\s*\([0-9]{4}\)/;let a=(e=e.replace(/_/g," ")).match(t);a&&(a=a[0].trim(),e=e.replace(t,"").trim());const[,,n,s,,o,i]=e.match(/(^(-?\d+)([,\.\-\s]))?((.*?)\s+-\s+)?(.*)/);return{album:a,artist:o,title:i,duration:","==s?qs(n):""}},Ms=e=>(B&&!Ss(e)&&(e.startsWith(H)&&(e=e.slice(9)),e=H+us(e)),e),Rs=e=>_n.children.length,Ds=(e=2)=>Math.random()*e|0,Fs=e=>{const t=new RegExp(`^${H}`);return Ps(ds(e.replace(t,"")))},Bs=e=>{Dn?(0,M.hZ)(Oe,e):Mn!=gt&&Mo(Oe,e)},qs=(e,t)=>{if(Math.abs(e)==1/0||"-1"===e)return"LIVE";let a="",n="",s="";return e<0&&(e=-e,n="-"),(e>=3600||t)&&(s=(e/3600|0)+":",e%=3600,a="0"),s+=(a+(e/60|0)).slice(-2)+":"+("0"+(e%60|0)).slice(-2),n+s},Hs=(e,t,a,n=1)=>{e.min=t,e.max=a,e.step=n};function Ns(e,t=!1){const a=e.map((e=>zs(e,t)));Promise.all(a).then((e=>{const t=e.reduce(((e,t)=>e+t),0),a=`${t} song${t>1?"s":""} added to the queue${Rs()<K?"":". Queue is full!"}`;F().alert({text:a,time:5}),ai(!0)}))}function js(e,t){const a=t.dataset,n=e.dataset,{album:s,artist:o,picture:i,title:l,year:r}=e.common||{},{bitrate:c,bitsPerSample:d,codec:u,codecProfile:f,container:h,duration:p,lossless:m,numberOfChannels:b,sampleRate:g}=e.format||{};if(n)Object.assign(a,n);else{a.artist=o||a.artist,a.title=l||a.title,a.album=s?s+(r?" ("+r+")":""):a.album,a.codec=u||h?(u||h)+" ("+b+"ch)":a.codec;const e=g?Math.round(g/1e3)+"kHz":"";if(a.quality=m||!c?(d?d+"bits":"")+(e&&d?" / ":"")+e:Math.round(c/1e3)+"kbps"+(f?" "+f:"")+(e?" / ":"")+e,a.duration=p?qs(p):"",i&&i.length){const e=new Blob([i[0].data],{type:i[0].format});a.cover=URL.createObjectURL(e)}}t==Zn[En]&&Ho()}function Us(e,t){return new Promise((a=>{if(Rs()>=K)return void a(0);const{fileName:n,baseName:s,extension:o}=Os(function(e){return e.replace(/%2[356]/g,(e=>({"%23":"#","%25":"%","%26":"&"}[e])))}(e.file)),i=Ps(e.file),l=document.createElement("li"),r=l.dataset;Object.assign(r,ce),t||(t=Is(s)),r.album=t.album||"",r.artist=t.artist||"",r.title=t.title||n||i.slice(i.lastIndexOf("//")+2),r.duration=t.duration||"",r.codec=t.codec||o.toUpperCase(),r.file=i,l.handle=e.handle,l.subs=e.subs,_n.appendChild(l),!be.includes(o)&&o||(r.retrieve=1,Ao()),1!=Rs()||$s()?a(1):ho(0).then((()=>a(1))),On>Rs()-3&&ro()}))}function zs(e,t=!1){let a;return a=ve.includes(Os(e.file).extension)?co(e):Us(e),a.then((e=>{t&&!$s()&&e>0&&ko(Rs()-e)})),a}function Ws(e){let t=e?fs((+Dt.dataset.value||0)+.1*e):0;t<-1?t=-1:t>1&&(t=1),Bo(t),qo("Balance: "+(0==t?"CENTER":100*Math.abs(t)+"% "+(t>0?"Right":"Left"))),di()}function Gs(e){const t=+Zt.value;(1==e&&t<+Zt.max||-1==e&&t>+Zt.min)&&(Zt.value=t+Zt.step*e,Go(Zt)),qo(`Analyzer height: ${Zt.value}%`)}function Ks(e){let t=fs((+nn.dataset.value||0)+.05*e);t<0?t=0:t>1&&(t=1),Jo(t),qo("Volume: "+20*t),di()}function Ys(e=En){const t=Zn[e],a=t.dataset;oo(t,null),po(t,null),Object.assign(a,ce),t.load(),e==En&&Ho()}function Vs(e=Ln){const t=e.pixelRatio,a=ya.height=zt.clientHeight*t,n=ya.width=zt.clientWidth*t;qn=Math.max(12,Math.min(n,a)/[24,17,13.5][+wa.value]),Hn=3*qn,Nn=n/2,jn=n-qn,Un=1.4*qn,zn=1.8*Un,Yn=n/3-qn,Wn=a-4*qn,Gn=a-2.8*qn,Kn=a-1.6*qn,Vn=n-8*qn,Xn=`bold ${.7*qn}px sans-serif`,Jn=`bold ${qn}px sans-serif`}function Xs(e,t,a){const n=At("#console-content"),s=new Date,o=s.toLocaleTimeString([],{hour12:!1})+"."+String(s.getMilliseconds()).padStart(3,"0");a&&(n.innerHTML=""),t&&At("#toggle_console").classList.add("warning"),e&&(n.innerHTML+=`<div ${t?'class="error"':""}>${o} &gt; ${e}</div>`),n.scrollTop=n.scrollHeight}function Js(e,t){const a=Ls(e)?e.elements[e.dataset.prop]:e.options;let n=(Ls(e)?Array.from(a).findIndex((e=>e.checked)):e.selectedIndex)+(t?-1:1);n<0?n=a.length-1:n>=a.length&&(n=0),Ls(e)?a[n].checked=!0:e.selectedIndex=n,Go(e)}function Zs(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function Qs(){ts&&ts.key&&(delete rn[ts.key],0===Object.keys(rn).filter((e=>!rn[e].disabled)).length&&(rn[Object.keys(rn)[0]].disabled=!1),Lo(),xo(),Io(xe),Io(Ee),ts=null,location.href="#config")}function eo(e,t){if(Es(Fn[e]))return;const a=`User Preset #${e+1}`,n=Fn[e].name?"<br>"+Fn[e].name:"";t?(Fn[e]={},Mo(Le,Fn),F().alert({text:`Deleted ${a}`})):F().confirm({text:`Do you really want to DELETE ${a}?${n}<br>THIS CANNOT BE UNDONE!`,submitText:"DELETE",submitCallback:()=>{eo(e,!0)},cancelCallback:()=>{F().alert({text:"Canceled!"})}})}function to(e=1){const t=Zn[En];if(t.duration>0&&t.duration<1/0){let a=t.currentTime+5*e;a<0?a=0:a>t.duration-1&&(a=t.duration-1),qo(1),t.currentTime=a}"m"==ns&&Do("m",e)}function ao(){return clearTimeout(Tn),!!ns&&(ns=!1,!0)}async function no(){Ts()&&await document.exitPictureInPicture(),Ln.toggleFullscreen(),document.activeElement.blur()}function so(e){if(e.altKey||e.ctrlKey||e.metaKey)return;const t=e.shiftKey;if("F1"==e.code&&!t)return location.href="#help",void e.preventDefault();if("BODY"==e.target.tagName){if("keydown"==e.type)switch(e.code){case"ArrowUp":t?Gs(1):Ks(1);break;case"ArrowDown":t?Gs(-1):Ks(-1);break;case"ArrowLeft":t?Ws(-1):ns?(qo("Rewind",1),to(-1)):Do("k",-1);break;case"ArrowRight":t?Ws(1):ns?(qo("Fast forward",1),to()):Do("k");break;default:return}else if(e.code.match(/^(Digit|Numpad)[0-9]$/)){const a=e.code.slice(-1)-1;if(-1==a)t||(Eo(!0),Go($a,!1));else if(t){const e=bs();e.randomMode=0,Ro(a,e)}else uo(a)}else switch(e.code){case"Delete":case"Backspace":_n.querySelectorAll(".selected").forEach((e=>{Po(e),e.remove()}));const e=hs(_n.querySelector(".current"));void 0!==e?On=e:On>Rs()-1?On=Rs()-1:On--,Rs()?ro():(Ys(An),$s()||Ys()),ai(!0);break;case"Space":qo($s()?"Pause":"Play",1),go();break;case"ArrowLeft":case"KeyJ":ao()||t||(qo("Previous track",1),ei(!0));break;case"KeyG":Js(Qt,t),qo(ys());break;case"ArrowRight":case"KeyK":ao()||t||(qo("Next track",1),ei());break;case"KeyA":Js($a,t),qo("Randomize: "+ps($a)),Go($a);break;case"KeyB":Js(t?qt:Rt);const a=Rt.value[0];qo("Background: "+ps(Rt)+(a>1&&a<7?` (${ps(qt)})`:""));break;case"KeyC":Ta.click(),qo("Radial "+_s(Ta));break;case"KeyD":ii();break;case"KeyE":Rs()>0&&(Qo(),qo("Shuffle"));break;case"KeyF":no();break;case"KeyH":Xt.click();break;case"KeyI":Na.click(),qo("Song info display "+_s(Na));break;case"KeyL":na.click(),qo("LED effect "+_s(na));break;case"KeyM":case"KeyV":Js(ha,t),qo("Mode: "+ps(ha));break;case"KeyN":Js(Fa,t),qo(ps(Fa).toUpperCase()+" sensitivity");break;case"KeyO":ra.click(),qo((Cs(ra)?"LOW":"HIGH")+" Resolution");break;case"KeyP":t?(Kt.click(),qo("Fade Peaks "+_s(Kt))):(Ha.click(),qo("Peaks "+_s(Ha)));break;case"KeyR":_a.click(),qo("Queue repeat "+_s(_a));break;case"KeyS":qo("Scale: "+["None","Frequency (Hz)","Level (dB)","Both"][function(e){let t=+Ra.dataset.active+(Da.dataset.active<<1)+(e?-1:1);return t<0?t=3:t>3&&(t=0),Ra.dataset.active=1&t,Da.dataset.active=t>>1,Go([Ra,Da]),t}(t)]);break;case"KeyT":ga.click(),qo((Cs(ga)?"Flat":"Shadowed")+" text mode");break;case"KeyU":ca.click(),qo("Luminance bars "+_s(ca));break;case"KeyX":Js(Pa,t),qo("Reflex: "+ps(Pa));break;default:return}e.preventDefault()}}function oo(e,t){const a=e.src||"";xs(a)&&URL.revokeObjectURL(a),t?e.src=t:e.removeAttribute("src"),zo()}function io(e,t,a){return new Promise((n=>{const s=URL.createObjectURL(e);oo(t,s),t.onloadeddata=()=>{a&&t.play(),t.onloadeddata=null,n(s)}}))}async function lo(e){return JSON.parse(B?await electron.api("storage-get",e):localStorage.getItem(e))}async function ro(){const e=On<Rs()-1?On+1:0,t=_n.children[e],a=Zn[An];if(Yo(),t){if(js(t,a),t.handle){try{await t.handle.requestPermission()}catch(e){}t.handle.getFile().then((e=>io(e,a))).then((()=>a.load())).catch((e=>{Xs(`Error loading ${t.dataset.file}`,!0),Ys(An)}))}else oo(a,t.dataset.file),a.load();po(a,t.subs)}os=!1}function co(e){let t=Ps(e.file);return new Promise((async a=>{let n=[];const s=e=>{Promise.all(n).then((t=>{const n=t.reduce(((e,t)=>e+t),0);a(n),e&&ai(!0)}))},o=async e=>{let a,o;la.dataset.path||Uo(t),t=Os(t).path;for(let s of e.split(/[\r\n]+/))if("#"!=s.charAt(0)&&""!=s.trim()){let e,i;if(s=Ps(s),o||(o=Os(s).baseName),!Ss(s)){if(Dn&&(({handle:e,subs:i}=await A(s)),!e)){Xs(`Cannot resolve file handle for ${s}`,!0),o="";continue}if(s=T(s),":"!=s[1]&&"/"!=s[0]&&(s=t+s),!Dn)try{const e=s.slice(0,s.lastIndexOf("."))+".vtt";(await fetch(e,{method:"HEAD"})).ok&&(i={src:e})}catch(e){}}n.push(Us({file:Ms(s),handle:e,subs:i},{...Is(o),...a?{album:a}:{}})),o=""}else s.startsWith("#EXTINF")?o=s.slice(8):s.startsWith("#EXTALB")&&(a=s.slice(8));s()};if(t)if("string"==typeof t&&ve.includes(Os(t).extension))e.handle?e.handle.getFile().then((e=>e.text())).then(o).catch((e=>{Xs(e,!0),a(0)})):fetch(t).then((e=>e.ok?e.text():(Xs(`Fetch returned error code ${e.status} for URI ${t}`,!0),""))).then(o).catch((e=>{Xs(e,!0),a(0)}));else{const e=await(0,M.Jt)(!0===t?De:qe+t);Array.isArray(e)?(e.forEach((e=>{const{file:t,handle:a,subs:s,content:o}=e;n.push(Us({file:t,handle:a,subs:s},o))})),s(e!=De)):(!0!==t&&Xs(`Unrecognized playlist file: ${t}`,!0),a(0))}else a(-1)}))}function uo(e,t=!0,a,n){const s=+e==e,o=s?Fn[e].options:vs(e),i=vs("default");Es(o)||(t&&Xs("Loading "+(s?"User Preset #"+(e+1):"'"+ks(e)+"' preset")),void 0!==o.stereo&&(o.channelLayout=dn[+o.stereo][0]),Pt("[data-prop]").forEach((e=>{const t=e.dataset.prop,s=void 0!==o[t]?o[t]:a?i[t]:void 0;if(void 0!==s&&(e!=$a||!n))if(Ls(e)){const t=e.querySelector(`[value="${s}"]`);t&&(t.checked=!0)}else e.classList.contains("switch")?e.dataset.active=+s:e==Dt?Bo(s):e==pa?ri(s):e==Ka?Ko(s):e==nn?Jo(s):(e.value=s,-1==e.selectedIndex&&(e.selectedIndex=0),ui(e))})),Ln.setOptions({alphaBars:Cs(_t),ansiBands:Cs(It),colorMode:ms(Ut),fadePeaks:Cs(Kt),fftSize:ms(Yt),frequencyScale:ms(Jt),ledBars:Cs(na),linearAmplitude:Cs(sa),loRes:Cs(ra),lumiBars:Cs(ca),maxFPS:ms(da),maxFreq:ms(Ca),minFreq:ms(Aa),mirror:ms(fa),noteLabels:Cs(va),outlineBars:Cs(ka),peakFadeTime:ms(xa),peakHoldTime:ms(La),radial:Cs(Ta),roundBars:Cs(Oa),showFPS:Cs(Xt),showPeaks:Cs(Ha),showScaleX:Cs(Ra),showScaleY:Cs(Da),smoothing:ms(Ua),spinSpeed:ms(Ya),splitGradient:Cs(Va),weightingFilter:ms(on)}),Go([Rt,qt,Bt,jt,Zt,ta,ia,Fa,Pa,Qt,ea,...n?[]:[$a],Ft,ja,ha]),"demo"==e&&Eo(!0),t&&F().alert({text:"Settings loaded!"}))}async function fo(e){Zs(Ea);const t=new Option("Select a playlist","");t.disabled=!0,t.selected=!0,Ea.options[Ea.options.length]=t;let a=await(0,M.Jt)(Re);const n=await lo(Re);if(n){for(const e of Object.keys(n)){const t=qe+e,s=await lo(t);let o=[];for(const e of s)o.push({file:e});await(0,M.hZ)(t,o),To(t),a[e]=n[e]}await(0,M.hZ)(Re,a),To(Re)}if(a)for(const t of Object.keys(a)){const n=new Option(a[t],t);n.dataset.isLocal="1",t==e&&(n.selected=!0),Ea.options[Ea.options.length]=n}fetch("playlists.cfg").then((e=>!!e.ok&&(Xs("Found legacy playlists.cfg file"),e.text()))).then((e=>{if(!1!==e){let t=0;e.split(/[\r\n]+/).forEach((e=>{if("#"!=e.charAt(0)&&""!=e.trim()){let a=e.split(/\|/);2==a.length&&(Ea.options[Ea.options.length]=new Option(a[0].trim(),a[1].trim()),t++)}})),t?Xs(`${t} playlists loaded from playlists.cfg`):Xs("No playlists found in playlists.cfg",!0)}})).catch((e=>{}))}function ho(e,t){return new Promise((async a=>{const n=Zn[En],s=()=>{li(),ro(),a(!0)};if(_n.children[e]){On=e;const o=_n.children[On];if(js(o,n),o.handle){try{await o.handle.requestPermission()}catch(e){}o.handle.getFile().then((e=>io(e,n,t))).then((()=>s())).catch((e=>{Xs(`Error loading ${o.dataset.file}`,!0),Ys(En),a(!1)}))}else oo(n,o.dataset.file),n.onloadeddata=()=>{t&&n.play(),n.onloadeddata=null,s()};po(n,o.subs)}else a(!1)}))}function po(e,t){const a=e.querySelector("track");if(xs(a.src)&&URL.revokeObjectURL(a.src),t){const{src:e,lang:n,handle:s}=t;a.srclang=n||navigator.language,s?s.getFile().then((e=>a.src=URL.createObjectURL(e))).catch((e=>{})):a.src=e}else a.removeAttribute("src"),a.removeAttribute("srclang")}function mo(){ts={name:"New Gradient",bgColor:"#111111",colorStops:[{pos:.1,color:"#222222"},{pos:1,color:"#eeeeee"}],disabled:!1,key:"custom-gradient-1"};let e=2;for(;Object.keys(rn).some((e=>e===ts.key))&&e<10;)ts.key=`custom-gradient-${e}`,e++;$o(),At("#btn-save-gradient").innerText="Add",At("#btn-delete-gradient").style.display="none",location.href="#gradient-editor"}function bo(e){if(os||Ka.checked||On>Rs()-1)return!0;if(os=!0,On<Rs()-1)On++;else{if(!Cs(_a))return os=!1,!1;On=0}return e|=$s(),[En,An]=[An,En],zo(),Ho(),e&&Zn[En].src?Zn[En].play().then((()=>ro())).catch((e=>{e.code!=me&&(Xs(e,!0),ro(),bo(!0))})):ro(),li(),!0}function go(e){Ka.checked||($s()&&!e?(Zn[En].pause(),Ts()&&cs.pause()):Zn[En].play().catch((e=>{e.code!=me&&(Xs(e,!0),bo(!0))})))}function vo(){let e=!0;return $s()?Zn[En].currentTime>2?Zn[En].currentTime=0:On>0?ko(On-1):e=!1:e=ho(On-1),e}function ko(e){ho(e,!0)}function yo(){let e=[{value:X,text:"Album cover"},{value:V,text:"Black"},{value:Y,text:"Gradient default"}];const t=e.length,a=Qn.length,n=es.length;e=[...e,...Qn.map(((e,t)=>({value:J+e.name,text:"ðŸ–¼ï¸ "+e.name,idx:t}))),...es.map(((e,t)=>({value:Z+e.name,text:"ðŸŽ¬ "+e.name,idx:t})))].slice(0,t+ +Nt.value),n&&e.splice(t,0,{value:Z,text:"Random video"}),a&&e.splice(t,0,{value:J,text:"Random image"}),So(Rt,e)}function wo(e,t){const a=!Array.isArray(t[0]);for(const n of a?t.filter((e=>!e.disabled)):t){const t=e.dataset.prop,a=n.text||n[1],s=n.value||n[0],o=t+"-"+s,i=document.createElement("input"),l=document.createElement("label");i.name=t,i.id=o,i.type="radio",i.value=s,l.htmlFor=o,l.innerText=a,e.append(i,l)}}function xo(){const e=At("#enabled_gradients");Zs(e),Object.keys(rn).forEach((t=>{t.startsWith("custom")?e.innerHTML+=`<label>\n\t\t\t       <input type="checkbox" class="enabledGradient" data-grad="${t}" ${rn[t].disabled?"":"checked"}>\n                   <a href="#" data-grad="${t}" class="grad-edit-link">${rn[t].name}</a>\n                </label>`:e.innerHTML+=`<label>\n\t\t\t       <input type="checkbox" class="enabledGradient" data-grad="${t}" ${rn[t].disabled?"":"checked"}>\n                   ${rn[t].name}\n                </label>`})),Pt(".enabledGradient").forEach((e=>{e.addEventListener("click",(t=>{if(!e.checked&&Object.keys(rn).reduce(((e,t)=>e+!rn[t].disabled),0)<2)return F().alert({text:"At least one Gradient must be enabled!"}),t.preventDefault(),!1;rn[e.dataset.grad].disabled=!e.checked,Lo(),Io(Ee)}))})),Pt(".grad-edit-link").forEach((e=>{e.addEventListener("click",(e=>{e.preventDefault(),function(e){if(!rn[e])throw new Error(`gradients[${e}] is null or undefined.`);const t=rn[e],a={};a.name=t.name,a.bgColor=t.bgColor,a.dir=t.dir,a.disabled=t.disabled,a.key=e,a.colorStops=[];for(const e of t.colorStops)a.colorStops.push({...e});ts=a}(e.target.getAttribute("data-grad")),$o(),At("#btn-save-gradient").innerText="Save",At("#btn-delete-gradient").style.display="block",location.href="#gradient-editor"}))}))}function Lo(){for(const e of[Qt,ea]){let t=e.value;Zs(e);for(const t of Object.keys(rn))rn[t].disabled||(e.options[e.options.length]=new Option(rn[t].name,t));""!==t&&(e.value=t,Go(e))}}function So(e,t){const a=e.value;Array.isArray(t)||(t=[t]),Zs(e);for(const a of t.filter((e=>e&&!e.disabled))){const t=new Option(a.text||a[1],a.value||a[0]);null===a[0]&&(t.disabled=!0),void 0!==a.idx&&(t.idx=a.idx),e[e.options.length]=t}""!==a&&(e.value=a,-1==e.selectedIndex&&(e.selectedIndex=0),Go(e))}function Eo(e=Ka.checked){if(!$s()&&!e)return;const t=e=>!un.find((t=>t.value==e)).disabled,a=(e,t=(()=>!0))=>{let a=9;do{if(Ls(e)){const t=e.elements[e.dataset.prop];t[Ds(t.length)].checked=!0}else if(void 0!==e.dataset.active)e.dataset.active=Ds();else if(e.step){const{min:t,max:a,step:n}=e,s=Ds((a-t)/n+1)*n+ +t;e.value=(10*s|0)/10,ui(e)}else e.selectedIndex=Ds(e.options.length)}while(!t(ms(e))&&a--);Go(e)};if(t(rt)){const e=Fn.map(((e,t)=>Es(e)?null:t)).filter((e=>null!==e)),t=e.length;t&&uo(e[Ds(t)],!1,!1,!0)}if(t(ot)&&a(ha),t(Ke)&&a(_t),t(Ye)&&a(Rt),t(Xe)&&a(qt),t(Je)&&a(jt,(e=>e!=de)),t(Ze)&&a(Ut),t(lt)&&a(Ha),t(tt)&&a(na),t(nt)&&a(ca,(e=>!+e||!Ln.overlay||!Cs(na))),t(at)&&a(oa),t(Qe)&&a(Vt),t(Ve)&&a(Ft),t(it)&&a(ka),t(ut)&&a(Pa,(e=>e!=Ge||!Cs(na))),t(ct)&&a(Ta),t(ft)&&a(Oa),t(dt)&&a(Ya),t(ht)&&a(Va),t(st)&&a(fa),t(et))for(const e of[Qt,...Cs(ia)?[]:[ea]])a(e)}function To(e){B?electron.api("storage-remove",e):localStorage.removeItem(e)}function $o(){if(null==ts)throw new Error("Current gradient must be set before editing gradient");const e=At("#grad-color-table");Zs(e),At("#new-gradient-name").value=ts.name,At("#new-gradient-horizontal").checked="h"===ts.dir;const t=At("#grad-row-label-template").cloneNode(!0);t.removeAttribute("id"),e.appendChild(t),ts.colorStops.forEach(((e,t)=>{!function(e,t){const a=At("#grad-color-table"),n=At("#grad-row-template").cloneNode(!0),s=n.querySelector(".grad-color-picker"),o=n.querySelector(".grad-color-value"),i=n.querySelector(".grad-color-stop"),l=n.querySelector(".grad-add-stop"),r=n.querySelector(".grad-remove-stop");s.value=t.color,o.value=t.color,i.value=t.pos,s.addEventListener("input",(t=>{o.value=t.target.value,ts.colorStops[e].color=s.value})),o.addEventListener("input",(t=>{s.value=t.target.value,ts.colorStops[e].color=s.value})),i.addEventListener("input",(t=>{ts.colorStops[e].pos=parseFloat(t.target.value)})),l.addEventListener("click",(()=>{ts.colorStops.splice(e+1,0,{pos:(()=>{if(e===ts.colorStops.length-1){const e=ts.colorStops[ts.colorStops.length-1].pos;return ts.colorStops[ts.colorStops.length-1].pos=(ts.colorStops[ts.colorStops.length-2].pos+e)/2,e}return(ts.colorStops[e].pos+ts.colorStops[e+1].pos)/2})(),color:"#111111"}),$o()})),2===ts.colorStops.length?r.setAttribute("disabled","true"):r.addEventListener("click",(()=>{ts.colorStops.splice(e,1),$o()})),n.removeAttribute("id"),a.appendChild(n)}(t,ts.colorStops[t])})),At("#new-gradient-bkgd").value=ts.bgColor}async function Co(){const e=Ht.value,t=new RegExp("\\.("+ge.join("|")+")$","i"),a=new RegExp("\\.("+ke.join("|")+")$","i");if(Qn=[],es=[],e==ee)try{const e=await fetch(W),n=await e.text();for(const{url:e,file:s}of P(n)){const n=Os(s).baseName;t.test(s)?Qn.push({name:n,url:W+"/"+e}):a.test(s)&&es.push({name:n,url:W+"/"+e})}}catch(e){}else if(e==te){const e=await(0,M.Jt)(we);try{if(e)for await(const[n,s]of e.entries())if(s instanceof FileSystemFileHandle){const e=t.test(n),o=a.test(n);if(e||o){const t=await s.getFile(),a=URL.createObjectURL(t);e?Qn.push({name:n,url:a}):es.push({name:n,url:a})}}}catch(e){}}if(e!=Q){const e=Qn.length,t=es.length;Xs("Found "+(e+t==0?"no media":e+" image files and "+t+" video")+" files in the backgrounds folder")}yo()}async function Ao(){if(is>=G)return;const e=Array.from(_n.children).find((e=>e.dataset.retrieve));if(e){let t=e.dataset.file,a=!1;is++,delete e.dataset.retrieve;e:{if(e.handle)try{if("granted"!=await e.handle.requestPermission())break e;t=URL.createObjectURL(await e.handle.getFile()),a=!0}catch(e){break e}try{const a=await I.WC(t,{skipPostHeaders:!0});a&&(js(a,e),ni(e),e.handle||a.common.picture&&a.common.picture.length||function(e){return new Promise((t=>{const a=Os(e).path;if(Mn==gt||Ss(e))t("");else if(void 0!==as[a])t(Ms(a+as[a]));else{const e=Mn==bt?N+us(a):a;fetch(e).then((e=>e.ok?e.text():null)).then((e=>{let n="";if(e)if(Mn==bt)n=e;else{const t=_(e);t.cover&&(n=t.cover)}as[a]=n,t(Ms(a+n))})).catch((e=>t("")))}}))}(t).then((t=>{e.dataset.cover=t,ni(e)})))}catch(e){}a&&URL.revokeObjectURL(t)}is--,Ao()}}function Po(e){const t=e.dataset.cover;xs(t)&&URL.revokeObjectURL(t)}function _o(){null!==ts&&(rn[ts.key]=ts,Ln.registerGradient(ts.key,ts),Lo(),xo(),Io(xe),ts=null,location.href="#config")}function Oo(e,t){if(0==Rs())return void F().alert({text:"Queue is empty!"});if(!e)return void F().input({text:"Playlist will be saved to the current folder.<br>Enter filename:",submitText:"Save",submitCallback:e=>{e?Oo($(e,!0)):F().alert({text:"Canceled"})},cancelCallback:()=>{F().alert({text:"Canceled"})}});const a=[];_n.childNodes.forEach((e=>{const{file:t,artist:n,title:s,duration:o}=e.dataset;a.push({file:Fs(t),artist:n,title:s,duration:o})})),fetch(j+e,{method:t?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:a})}).then((e=>e.ok?e.json():{error:`Cannot save file (ERROR ${e.status})`})).then((({file:e,error:a})=>{const n=e?`${t?"Updated":"Saved as"} ${Os(e).fileName}`:a;F().alert({text:n}),Uo(e),E(null,b.scrollTop)}))}function Io(e){const t=e=>e.map((({value:e,disabled:t})=>({value:e,disabled:t})));if(e&&e!=Te||Mo(Te,t(cn)),e&&e!=Se||Mo(Se,t(pn)),e&&e!=Ee||Mo(Ee,Object.keys(rn).map((e=>({value:e,disabled:rn[e].disabled})))),!e||e==xe){const e={};Object.keys(rn).filter((e=>e.startsWith("custom"))).forEach((t=>e[t]=rn[t])),Mo(xe,e)}if(e&&e!=$e||Mo($e,t(un)),!e||e==Fe){let e=[];for(const t of[0,1,2])e.push({min:At(`.min-db[data-preset="${t}"]`).value,max:At(`.max-db[data-preset="${t}"]`).value,boost:At(`.linear-boost[data-preset="${t}"]`).value});Mo(Fe,e)}if(!e||e==Ce){const e={info:aa.value,track:tn.value,end:Gt.value,covers:qa.checked,count:Ba.checked};Mo(Ce,e)}if(!e||e==Pe){const e={autoHide:Mt.checked,bgLocation:Ht.value,bgMaxItems:Nt.value,fftSize:Yt.value,fsHeight:Zt.value,maxFPS:da.value,noDimSubs:ma.checked,noDimVideo:ba.checked,pipRatio:Sa.value,saveDir:Ia.checked,saveQueue:Ma.checked,smoothing:Ua.value};Mo(Pe,e)}if(!e||e==Me){const e={gravity:ta.value,peakFade:xa.value,peakHold:La.value};Mo(Me,e)}if(!e||e==Be){const e={background:Xa.value,color:Ja.value,position:Za.value};Mo(Be,e)}}function Mo(e,t){const a=JSON.stringify(t);B?electron.api("storage-set",e,a):localStorage.setItem(e,a)}function Ro(e,t,a,n){const s=`User Preset #${e+1}`,o=Fn[e].name||"",i=Ln.isFullscreen;if(!Es(Fn[e])&&!n&&ss!==e)return void(i?(qo(`Overwrite ${s} - Press again to confirm!`,5),ss=e,setTimeout((()=>{ss===e&&(ss=!1)}),5e3)):F().confirm({text:`Do you really want to overwrite ${s}?<br>${o}`,submitText:"Overwrite",submitCallback:()=>{Ro(e,t,a,!0)},cancelCallback:()=>{F().alert({text:"Canceled!"})}}));if(ss=!1,!a||!`${a}`.trim()){if(!i)return void F().input({text:"Give this preset a name or short description",submitText:"Save",value:o,maxlength:40,submitCallback:a=>{Ro(e,t,a.trim()||ze,!0)},cancelCallback:()=>{F().alert({text:"Save canceled!"})}});a=""}a==ze&&(a=""),Fn[e]={name:a,options:t},Mo(Le,Fn);const l=`Saved to ${s}`;i?qo(l,5):F().alert({text:l})}function Do(e,t=1){Tn=setTimeout((()=>{ns=e,to(t)}),200)}function Fo(e){document.documentElement.style.setProperty("--background-image",e?`url('${e.replace(/['()]/g,"\\$&")}')`:"none")}function Bo(e){Dt.dataset.value=e,Pn&&(Pn.pan.value=Math.log10(9*Math.abs(e)+1)*Math.sign(e)),Dt.querySelector(".marker").style.transform=`rotate( ${145*e-90}deg )`}function qo(e,t=2,a=-1){if(e){const n=performance.now(),s=n+1e3*t;e==+e?(Sn.info=e,Sn.startTime=n,Sn.endTime=Math.max(s,Sn.endTime||0),Sn.fade=t==1/0?0:t/3*a):(Sn.msg=e,2==Sn.info&&(Sn.info=1),Sn.msgTimer=s)}else Sn={endTime:0,msgTimer:0}}function Ho(){rs.src=Zn[En].dataset.cover,Rt.value==X&&Fo(rs.src)}function No(e){Mt.checked=e.autoHide,Ht.value=e.bgLocation,Nt.value=e.bgMaxItems,Yt.value=e.fftSize,Zt.value=e.fsHeight,da.value=e.maxFPS,ma.checked=e.noDimSubs,ba.checked=e.noDimVideo,wa.value=e.osdFontSize,Sa.value=e.pipRatio,Ia.checked=e.saveDir,Ma.checked=e.saveQueue,Ua.value=e.smoothing}function jo(e){aa.value=e.info,tn.value=e.track,Gt.value=e.end,qa.checked=e.covers,Ba.checked=e.count}function Uo(e=""){B&&(e=Fs(e),la.dataset.path=us(e),la.innerText=Os(e).fileName,la.title=ds(e,!0))}function zo(){const e=Rt.value[0],t=Cs(ja)&&!!Zn[En].querySelector("track").src,a=As(),n=a||t||e!=Y&&e!=V;for(const e of Zn)e.style.display=(a||t)&&e==Zn[En]?"":"none";return Ln.overlay=n,Ln.showBgColor=!a&&e==Y,zt.style.backgroundImage=a?"none":"var(--background-image)",an.style.display=a||e!=Z?"none":"",Wt.style.display=a&&ba.checked||t&&ma.checked?"none":"",n}function Wo(e){ta.value=e.gravity,xa.value=e.peakFade,La.value=e.peakHold}function Go(e,t=!0){Array.isArray(e)||(e=[e]);const a=()=>ea.style.display=ms(jt)==ue||Cs(ia)?"none":"";for(const n of e){switch(n){case _t:Ln.alphaBars=Cs(_t);break;case It:Ln.ansiBands=Cs(It);break;case Mt:oi(!0);break;case Rt:const e=Rt.value[0],s=Rt[Rt.selectedIndex].idx,o=zo();if(e==Z){Fo();const e=es[void 0===s?Ds(es.length):s].url;try{decodeURIComponent(an.src).endsWith(decodeURIComponent(e))||(an.src=e)}catch(t){an.src=e}}else o&&![Y,V].includes(e)?Fo(e==X?rs.src:Qn[void 0===s?Ds(Qn.length):s].url):Fo();break;case Ft:Ln.barSpace=Ln.isLumiBars?1.5:ms(Ft);break;case qt:const i=qt.value,l=i==ie||i==le||i==re;zt.classList.toggle("repeat",i==se),zt.classList.toggle("cover",i==ae||l),zt.style.backgroundSize="",sn.style.display=l?"":"none",sn.classList.toggle("rotating",i==re),sn.classList.toggle("paused",i==ie);break;case Bt:Wt.style.background=`rgba(0,0,0,${1-Bt.value})`;break;case Ht:Ht.value==te?window.showDirectoryPicker({startIn:"pictures"}).then((e=>{(0,M.hZ)(we,e)})).catch((e=>{Ht.value=Q,(0,M.yH)(we)})).finally((()=>Co())):((0,M.yH)(we),Co());break;case Nt:yo();break;case jt:Ln.channelLayout=ms(jt),a();break;case Ut:Ln.colorMode=ms(Ut);break;case Kt:Ln.fadePeaks=Cs(Kt);break;case Vt:Ln.fillAlpha=ha.value==He?1:Vt.value;break;case Yt:Ln.fftSize=Yt.value,Xs("FFT size is "+Ln.fftSize+" samples");break;case Xt:Ln.showFPS=Cs(Xt);break;case Jt:Ln.frequencyScale=ms(Jt);break;case Zt:Ot.style.height=`${Zt.value}%`;break;case Qt:case ea:""===n.value&&(n.selectedIndex=0),Cs(ia)?Ln.gradient=Qt.value=ea.value=n.value:Ln[n==Qt?"gradientLeft":"gradientRight"]=n.value;break;case na:Ln.ledBars=Cs(na);break;case sa:Ln.linearAmplitude=Cs(sa);break;case oa:Ln.lineWidth=ha.value==He?0:oa.value;break;case ia:a(),Cs(ia)&&Go(Qt,!1);break;case ra:Ln.loRes=Cs(ra);break;case ca:Ln.lumiBars=Cs(ca),Go(Ft,!1);break;case da:Ln.maxFPS=da.value;break;case fa:Ln.mirror=ms(fa);break;case ha:const r=ha.value;[He,Ne].includes(r)?Ln.mode=10:Ln.mode=r,r==He?(Ln.lineWidth=0,Ln.fillAlpha=1):(Ln.lineWidth=oa.value,Ln.fillAlpha=Vt.value),Go(Ft,!1);break;case pa:ri();break;case ma:case ba:zo();break;case va:Ln.noteLabels=Cs(va);break;case wa:Vs();break;case ka:Ln.outlineBars=Cs(ka);break;case ta:Ln.gravity=ta.value;break;case xa:Ln.peakFadeTime=xa.value;break;case La:Ln.peakHoldTime=La.value;break;case Sa:Ts()&&(Ln.width=Ln.height*Sa.value);break;case Ta:Ln.radial=Cs(Ta),Go(Ft,!1);break;case $a:const c=$a.value;In&&(In=clearInterval(In)),c>1&&(In=setInterval(Eo,2500*c));break;case Aa:case Ca:for(;+Ca.value<=+Aa.value;)Ca.selectedIndex++;Ln.setFreqRange(Aa.value,Ca.value);break;case Pa:switch(ms(Pa)){case We:Ln.reflexRatio=.4,Ln.reflexAlpha=.2;break;case Ge:Ln.reflexRatio=.5,Ln.reflexAlpha=1;break;default:Ln.reflexRatio=0}break;case Oa:Ln.roundBars=Cs(Oa);break;case Ia:Ia.checked?Bs(v):((0,M.yH)(Oe),To(Oe));break;case Ma:Ma.checked?ai(!0):(0,M.yH)(De);break;case Ra:Ln.showScaleX=Cs(Ra);break;case Da:Ln.showScaleY=Cs(Da);break;case Fa:const d=ms(Fa);Ln.setSensitivity(At(`.min-db[data-preset="${d}"]`).value,At(`.max-db[data-preset="${d}"]`).value),Ln.linearBoost=At(`.linear-boost[data-preset="${d}"]`).value;break;case Ha:Ln.showPeaks=Cs(Ha);break;case ja:Yo();break;case Ua:Ln.smoothing=Ua.value,Xs("smoothingTimeConstant is "+Ln.smoothing);break;case Ka:const u=Ka.checked;t=!1,Ko(u,(e=>{u&&e?(Bn=pa.checked,ri(!0)):u||ri(!!Bn),di()}));break;case Ya:Ln.spinSpeed=Ya.value;break;case Va:Ln.splitGradient=Cs(Va);break;case Xa:case Ja:zt.className=zt.className.replace(new RegExp(`(${xt}|${Lt}).*`,"gi"),""),zt.classList.add(xt+Xa.value,Lt+Ja.value);break;case Za:Xo({target:Zn[En].querySelector("track")});break;case on:Ln.weightingFilter=ms(on)}t&&(mn.includes(n)?Io(Pe):kn.includes(n)?Io(Me):wn.includes(n)?Io(Be):di())}}async function Ko(e,t){Ka.checked=e,e?B&&!await electron.api("ask-for-media-access")||!navigator.mediaDevices?(Xs("Cannot access user microphone",!0),Ka.checked=!1,t&&t(!1)):navigator.mediaDevices.getUserMedia({audio:!0}).then((e=>{Cn=Ln.audioCtx.createMediaStreamSource(e),$s()&&Zn[En].pause(),Ln.connectInput(Cn),Xs("Audio source set to microphone")})).catch((e=>{Xs(`Could not change audio source - ${e}`,!0),Ka.checked=!1})).finally((()=>{t&&t(Ka.checked)})):(Cn&&(Ln.disconnectInput(Cn),Cn.mediaStream.getTracks()[0].stop(),Cn=null),Xs("Audio source set to built-in player"),t&&t(!0))}function Yo(){for(const e of Zn)e.textTracks[0].mode="hidden",Cs(ja)&&(e.textTracks[0].mode="showing");zo()}function Vo(e){Xa.value=e.background,Ja.value=e.color,Za.value=e.position}function Xo(e){if(!e.target.track)return;let t,a,n=!1;switch(Za.value){case St:t="end",a=95;break;case Et:t="center",a=50;break;default:t="start",a=1,n=!0}for(const s of e.target.track.cues)s.line=a,s.snapToLines=n,s.lineAlign=t}function Jo(e){nn.dataset.value=e,Ln.volume=e**2.5,nn.querySelector(".marker").style.transform=`rotate( ${125+290*e}deg )`}function Zo(){let e;zt.addEventListener("mouseenter",(()=>{Mt.checked&&!Ln.isFullscreen&&setTimeout((()=>{zt.matches(":hover")&&oi(!1)}),300)})),At(".panel-area").addEventListener("mouseenter",(()=>oi(!0))),zt.addEventListener("transitionend",(()=>{zt.style.height&&(ua.style.display="none"),document.body.style.overflowY=window.innerHeight<Ct?"scroll":""})),en.addEventListener("click",(()=>{oi(!0),ci()})),At(".settings-close").addEventListener("click",(()=>ci())),Qa.addEventListener("click",(()=>{oi(!0),si(),Qa.classList.remove("warning"),Xs()})),At("#console-close").addEventListener("click",(()=>si())),At("#console-clear").addEventListener("click",(()=>Xs("Console cleared.",!1,!0))),Pt(".switch").forEach((e=>{e.addEventListener("click",(()=>{e.dataset.active=+!+e.dataset.active,Go(e)}))})),Pt("[data-prop]").forEach((e=>{Ls(e)?e.elements[e.dataset.prop].forEach((t=>{t.addEventListener("click",(()=>Go(e)))})):e.addEventListener("change",(()=>{Go(e),ui(e)}))})),[nn,Dt].forEach((t=>{t.addEventListener("wheel",(a=>{if(a.preventDefault(),e)return;e=setTimeout((()=>e=!1),50);const n=Math.sign(a.deltaY||0);t==nn?Ks(n):Ws(n)}))})),Dt.addEventListener("dblclick",(()=>{Ws(0)})),At("#btn_play").addEventListener("click",(()=>go())),At("#btn_stop").addEventListener("click",ti),At("#btn_shuf").addEventListener("click",Qo),At("#btn_prev").addEventListener("mousedown",(()=>Do("m",-1))),At("#btn_prev").addEventListener("click",(e=>{ao()||ei(!0)})),At("#btn_next").addEventListener("mousedown",(()=>Do("m"))),At("#btn_next").addEventListener("click",(()=>{ao()||ei()})),Ga.addEventListener("input",(()=>{const e=Zn[En],{duration:t}=e;t&&t!=1/0?e.currentTime=t*Ga.value:Ga.value=0})),At("#load_preset").addEventListener("click",(()=>{const e=[];ln.forEach((t=>{Es(t.options)||e.push({text:t.name+("default"==t.key?" (warning: resets Volume!)":""),handler:()=>uo(t.key)})})),e.push({text:"<strong>USER PRESETS â†’</strong>",handler:()=>{const e=[];ws().forEach(((t,a)=>{e.push({text:t,handler:()=>uo(a)})})),F().select({text:"LOAD PRESET:",choices:e})}}),F().select({text:"LOAD PRESET:",choices:e})})),At("#btn_save").addEventListener("click",(()=>{const e=[];ws().forEach(((t,a)=>{const n=Fn[a].options;e.push({type:1,text:t,handler:()=>Ro(a,bs())},{type:2,text:Es(n)?"":'<button title="Edit name">&#xf11f;</button>',handler:()=>Ro(a,n,"",!0)},{type:2,text:Es(n)?"":'<button title="Delete preset">&#xf120;</button>',handler:()=>eo(a)})})),F().select({text:"<strong>Click slot to SAVE - Use buttons to Edit or Delete</strong>",choices:e})})),At("#btn_fullscreen").addEventListener("click",no),At("#save_playlist").addEventListener("click",(()=>{if(B){const e=la.dataset.path;e?F().confirm({text:`<strong>${la.innerText}</strong><br>will be overwritten with the current play queue<br>ARE YOU SURE?`,submitText:"Overwrite",submitCallback:()=>Oo(e,!0),cancelCallback:()=>F().alert({text:"Canceled"})}):Oo()}else e=Ea.selectedIndex,""==Ea[e].value?ai():Ea[e].dataset.isLocal?F().confirm({text:`Overwrite "${Ea[e].innerText}" with the current play queue?`,submitText:"Overwrite",submitCallback:()=>{ai(Ea[e].value)},cancelCallback:()=>{F().alert({text:"Canceled"})}}):F().alert({text:'This is a server playlist which cannot be overwritten.<br>Click "Save as..." to create a new local playlist.',time:5});var e})),At("#create_playlist").addEventListener("click",(()=>B?Oo():ai())),At("#btn_clear").addEventListener("click",(()=>{!function(){for(;_n.hasChildNodes();)Po(_n.removeChild(_n.firstChild));$s()?On=-1:(On=0,Ys(En)),Ys(An),li()}(),Uo(),ai(!0)})),(B?At(".playlist-bar"):la).style.display="none",B||(At("#load_playlist").addEventListener("click",(()=>{co({file:Ea.value}).then((e=>{const t=-1==e?"No playlist selected":`${e} song${e>1?"s":""} added to the queue`;F().alert({text:t,time:5})}))})),At("#delete_playlist").addEventListener("click",(()=>{return e=Ea.selectedIndex,void(Ea[e].dataset.isLocal?F().confirm({text:`Do you really want to DELETE the "${Ea[e].innerText}" playlist?<br>THIS CANNOT BE UNDONE!`,submitText:"Delete",submitCallback:async()=>{const t=Ea[e].value,a=qe+t,n=await(0,M.Jt)(Re);n&&delete n[t],await(0,M.yH)(a),await(0,M.hZ)(Re,n),F().alert({text:"Playlist deleted"}),fo()},cancelCallback:()=>{F().alert({text:"Canceled"})}}):Ea[e].value&&F().alert({text:"Cannot delete a server playlist!"}));var e}))),ya.addEventListener("click",(()=>ii()));const t=At("#btn_toggle_filesystem"),a=()=>t.innerText="Switch to "+(Dn?"Server":"Device");($n||Dn)&&Rn?(a(),t.addEventListener("click",(async()=>{Dn=!Dn;const e=await(Dn?(0,M.Jt)(Oe):lo(Oe));Dn&&e&&"granted"!=await e[0].handle.requestPermission()?Dn=!1:(L=!L,v=[],f=null,y=[L?r:s],O(e),a(),Mo(Ae,Dn))}))):t.style.display="none";const n=At("#btn_add_selected"),o=At("#btn_add_folder");B||$n||Dn?(n.addEventListener("mousedown",(()=>Ns(C(".selected")))),o.addEventListener("click",(()=>Ns(C())))):(n.style.display="none",o.style.display="none");const i=At("#local_file");let l,c;B||Rn?i.parentElement.style.display="none":i.addEventListener("change",(e=>function(e){const t=e.files[0];if(t){Ys();const e=Zn[En];e.dataset.file=t.name,e.dataset.title=Os(t.name).baseName,io(t,e,!0).then((e=>I.WC(e))).then((t=>js(t,e))).catch((e=>{}))}}(e.target))),At("#btn_load_url").addEventListener("click",(()=>{F().input({text:"Load audio file or stream from URL",submitText:"Load",submitCallback:e=>{e.trim()&&(zs({file:e},!0),ai(!0))}})}));const d=At("#btn_pip");document.pictureInPictureEnabled?d.addEventListener("click",(async()=>{if(cs!==document.pictureInPictureElement){const e=Ln.canvas.captureStream();l=e.getTracks()[0],cs.muted=!0,cs.srcObject=e,await cs.play(),cs.requestPictureInPicture()}else document.exitPictureInPicture()})):d.classList.add("disabled");const u=((e,t=300)=>{let a;return(...n)=>{clearTimeout(a),a=setTimeout((()=>e.apply(this,n)),t)}})((()=>Ln.setCanvasSize(c.width,c.height)));cs.addEventListener("enterpictureinpicture",(e=>{c=e.pictureInPictureWindow,zt.classList.add("pip"),d.classList.add("active"),Ln.setCanvasSize(c.height*Sa.value,c.height),c.addEventListener("resize",u)})),cs.addEventListener("leavepictureinpicture",(()=>{c.removeEventListener("resize",u),cs.pause(),l.stop(),cs.srcObject=l=null,d.classList.remove("active"),zt.classList.remove("pip"),Ln.setCanvasSize()}));const h=navigator.mediaSession;h&&(h.setActionHandler("play",(()=>go())),h.setActionHandler("pause",(()=>go())),h.setActionHandler("previoustrack",(()=>vo())),h.setActionHandler("nexttrack",(()=>bo()))),At("#add-gradient").addEventListener("click",mo),At("#btn-save-gradient").addEventListener("click",_o),At("#btn-delete-gradient").addEventListener("click",Qs),At("#new-gradient-bkgd").addEventListener("input",(e=>{ts.bgColor=e.target.value})),At("#new-gradient-name").addEventListener("input",(e=>{ts.name=e.target.value})),At("#new-gradient-horizontal").addEventListener("input",(e=>{ts.dir=e.target.checked?"h":void 0}));const p=Pt("details");p.forEach((e=>{e.addEventListener("click",(()=>{e.open||p.forEach((e=>e.open=!1))}))}))}function Qo(){for(let e=Rs()-1;e>0;e--){const t=Math.random()*(e+1)|0,a=_n.replaceChild(_n.children[t],_n.children[e]);_n.insertBefore(a,_n.children[t])}ko(0),ai(!0)}function ei(e=!1){(e?vo():bo())||qo(`Already at ${e?"first":"last"} track`)}function ti(){Zn[En].pause(),qo(),ho(0)}async function ai(e,t=!0){const a=1==e;if(!a||Ma.checked)if(0!=Rs()||a)if(e){let n=e;if(!a&&!t){n=n.normalize("NFD").replace(/[\u0300-\u036f]/g,""),n=n.toLowerCase().replace(/[^a-z0-9]/g,"_");let t=await(0,M.Jt)(Re)||{},a=0,s=n;for(;t.hasOwnProperty(n)&&a<100;)n=s+"_"+a,a++;t[n]=e,await(0,M.hZ)(Re,t),fo(n)}let s=[];for(const e of _n.childNodes){const{album:t,artist:a,codec:n,duration:o,file:i,title:l}=e.dataset,{handle:r,subs:c}=e;s.push({file:i,handle:r,subs:c,content:{album:t,artist:a,codec:n,duration:o,title:l}})}a?(0,M.hZ)(De,s):(0,M.hZ)(qe+n,s).then((()=>F().alert({text:"Playlist saved!"})))}else F().input({text:"Give this playlist a name:",submitText:"Save",submitCallback:e=>{e&&ai(e,!1)},cancelCallback:()=>{F().alert({text:"Canceled"})}});else F().alert({text:"Queue is empty!"})}function ni(e){for(const t of Zn)t.dataset.file==e.dataset.file&&js(e,t)}function si(e){At("#console").classList.toggle("active",Qa.classList.toggle("active",e))}function oi(e){window.innerHeight>=Ct&&(document.body.style.overflowY="hidden"),e?ua.style.display="":(si(!1),ci(!1)),zt.style.height=e?"":"calc( 100vh - 160px )"}function ii(){Sn.endTime<performance.now()&&(Sn.info=0),2==Sn.info?qo():qo(1+(0|Sn.info),+aa.value||1/0)}function li(){const e=_n.querySelector(".current"),t=_n.children[On];e&&e.classList.remove("current"),t&&(t.classList.add("current"),t.scrollIntoViewIfNeeded())}function ri(e){void 0!==e?pa.checked=e:e=pa.checked,e?Ln.disconnectOutput():Ln.connectOutput()}function ci(e){At("#settings").classList.toggle("active",en.classList.toggle("active",e))}function di(){Mo(_e,{...bs(),balance:Dt.dataset.value,micSource:Ka.checked,mute:pa.checked,volume:nn.dataset.value})}function ui(e){const t=e.previousElementSibling;t&&"value"==t.className&&(t.innerText=e.value)}!async function(){const e=e=>{bo(!0)||(ho(0),qo("Queue ended",10),Ts()&&cs.pause())},t=e=>{e.target.attributes.src&&Xs("Error loading "+e.target.src,!0)},a=e=>{Zn[En].attributes.src?(Ts()&&cs.play(),Zn[En].currentTime<.1&&"1"==$a.value&&Eo(!0),Cs(Na)&&qo(1,+tn.value||1/0)):ko(On)},c=e=>{if(e.target!=Zn[En])return;const{currentTime:t,duration:a}=Zn[En];Ga.value=a&&a!=1/0?t/a:0,Wa.innerText=qs(t,!0),za.innerHTML=qs(a?t-a:0,!0).padEnd(6).replaceAll(" ","&nbsp;")};window.addEventListener("error",(e=>Xs(`Unexpected ${e.error}`,!0)));let d=!1;Xs(`audioMotion v${z} initializing...`),Xs(`User agent: ${navigator.userAgent}`),At("#version").innerText=z;const T=await lo(Ie),C=At("#update-banner");let A;null!=T&&T!=z||C.remove(),T!=z&&(Mo(Ie,z),null!=T&&(C.classList.add(Tt),C.addEventListener("click",(()=>C.classList.remove(Tt))),setTimeout((()=>{C.classList.remove(Tt)}),1e4)));try{A=await fetch(vt)}catch(e){}let P=A&&A.ok?await A.text():null;try{P=JSON.parse(P)}catch(e){Xs(`Error parsing ${vt} - ${e}`,!0),P={}}P={...kt,...P},Rn=P.enableLocalAccess&&!!window.showDirectoryPicker;const _="audiomotion.app"!=window.location.hostname,I=new URL(window.location).searchParams,D=I.get("mode"),q=I.get("mediaPanel");let H=P.enableLocalAccess&&(!_||D==ye||"server"!=D&&await lo(Ae));null===H&&(H=P.defaultAccessMode==ye),(q==je||P.mediaPanel==je&&q!=Ue)&&oi(!1),B&&Xs(`Reading user preferences from ${await electron.api("storage-info")}`);const N=await async function(){const e=(e,t)=>{Array.isArray(e)&&e.forEach((e=>{const{value:a,disabled:n}="object"==typeof e?e:{value:e,disabled:!0},s=Array.isArray(t)?t.find((e=>e.value==a)):t[a];s&&(s.disabled=n)}))},t=await lo(_e),a=null!==t;((e,t)=>{const a=gs("last");-1!=a&&(ln[a].options=t)})(0,{...vs("default"),...t}),Fn=await lo(Le)||[],Array.isArray(Fn)||(Fn=[{name:"Custom",options:Fn}]);for(let e=0;e<9;e++)void 0===Fn[e]?Fn[e]={}:Es(Fn[e])||Fn[e].options||(Fn[e]={options:Fn[e]});e(await lo(Te),cn),e(await lo(Se),pn);const n=await lo(xe);n&&Object.keys(n).forEach((e=>{rn[e]=n[e]})),e(await lo(Ee),rn),e(await lo($e),un);const s=Pt(".min-db");s.forEach((e=>Hs(e,-120,-60)));const o=Pt(".max-db");o.forEach((e=>Hs(e,-50,0)));const i=Pt(".linear-boost");i.forEach((e=>Hs(e,1,5,.2))),(await lo(Fe)||fn).forEach(((e,t)=>{s[t].value=e.min,o[t].value=e.max,i[t].value=e.boost||fn[t].boost})),jo({...hn,...await lo(Ce)||{}});for(let e=10;e<16;e++)Yt[Yt.options.length]=new Option(2**e);return Hs(Ua,0,.9,.1),So(Sa,vn),Hs(Zt,25,100,5),So(da,gn),So(Ht,[[Q,"Disable"],[ee,"Built-in"],[...Rn?[te,"Local folder"]:[]]]),Hs(Nt,0,100),So(wa,[["0","Small"],["1","Medium"],["2","Large"]]),No({...bn,...await lo(Pe)||{}}),Hs(ta,.01,25,.01),Hs(xa,0,5e3,50),Hs(La,0,5e3,50),Wo({...yn,...await lo(Me)||{}}),So(Xa,[["none","None"],[yt,"Shadow"],["solid","Solid"]]),So(Ja,[["gold","Gold"],["gray","Gray"],[wt,"White"],["yellow","Yellow"]]),So(Za,[["top","Top"],[Et,"Center"],[St,"Bottom"]]),Vo({...xn,...await lo(Be)||{}}),a}();_n=At("#playlist"),_n.addEventListener("dblclick",(e=>{e.target&&e.target.dataset.file&&(ko(hs(e.target)),e.target.classList.remove("selected","sortable-chosen"))})),On=0,R.Ay.create(_n,{animation:150,group:{name:"filelist",pull:!1,put:!0},multiDrag:!0,multiDragKey:"ctrl",selectedClass:"selected",onEnd:e=>{On=hs(_n.querySelector(".current")),0!=e.newIndex||$s()||ho(0),ro(),ai(!0)}}),Xs(`Instantiating audioMotion-analyzer v${n.A.version}`),Ln=new n.A(Ot,{bgAlpha:0,fsElement:zt,onCanvasDraw:(e,t)=>{if(!Zn.length)return;const a=Zn[En],n=a.dataset,s=a.duration-a.currentTime,o=+Gt.value,i=Rt.value[0],l=qt.value,r=Cs(ga),c=e.pixelRatio,{timestamp:d}=t;if(s<.1&&bo(!0),o>0&&s<=o&&Cs(Na)&&d>Sn.endTime&&$s()&&qo(1,s,1),!(l!=oe&&"4"!=l&&"5"!=l||i!=X&&i!=J)){let t;if(l==oe)t=(70*e.getEnergy()|0)-25;else{const e=a.currentTime/a.duration;t=100*("4"==l?e:1-e)}zt.style.backgroundSize=`auto ${100+t}%`}ya.width|=0;const{endTime:u,startTime:f,msgTimer:h,info:p,msg:m,fade:b}=Sn;if(d>u&&d>h)return;const g=(e,t,a,n)=>{r?(ls.strokeText(e,t,a,n),ls.fillText(e,t,a,n)):(ls.shadowOffsetX=ls.shadowOffsetY=3*c,ls.fillText(e,t,a,n),ls.shadowOffsetX=ls.shadowOffsetY=0)};if(ls.lineWidth=4*c,ls.lineJoin="round",ls.font=Xn,ls.textAlign="center",ls.fillStyle="#fff",ls.strokeStyle=ls.shadowColor="#000",h>d&&(d>u||2!=p)){const e=(h-d)/1e3;ls.globalAlpha=e>1?1:e,g(Sn.msg,Nn,Un)}if(u>d){if(b<0){const e=(u-d)/1e3;ls.globalAlpha=e>-b?1:e/-b}else{const e=Math.max(0,(d-f)/1e3);ls.globalAlpha=e>b?1:e/b}if(2==Sn.info&&(g(ys(),Nn,Un,Yn),ls.textAlign="left",g(ps(ha),qn,Un,Yn),g(`Randomize: ${ps($a)}`,qn,zn,Yn),ls.textAlign="right",g(ps(Fa).toUpperCase()+" sensitivity",jn,Un,Yn),g(`Repeat is ${_s(_a)}`,jn,zn,Yn)),Ka.checked)ls.textAlign="left",ls.font=Jn,g("MIC source",qn,Gn,Vn);else{ls.textAlign="right",g(n.codec,jn,Wn),g(n.quality,jn,Wn+qn);const e=Rs();e&&Ba.checked&&g(`Track ${On+1} of ${e}`,jn,Wn-qn),ls.textAlign="left",g(n.artist.toUpperCase(),qn,Wn,Vn),ls.font=`italic ${Xn}`,g(n.album,qn,Kn,Vn),ls.font=Jn,g(a.src?n.title:"No song loaded",qn,Gn,Vn),(a.duration||n.duration)&&(n.duration||(n.duration=qs(a.duration),_n.children[On]&&(_n.children[On].dataset.duration=n.duration)),ls.textAlign="right",g(qs(a.currentTime)+" / "+n.duration,jn,Kn)),rs.width&&qa.checked&&ls.drawImage(rs,qn,Wn-1.3*Hn,Hn,Hn)}}},onCanvasResize:(e,t)=>{let a;switch(Vs(t),e){case"create":Xs(`Display resolution: ${t.fsWidth} x ${t.fsHeight} px (pixelRatio: ${window.devicePixelRatio})`),a="Canvas created";break;case"lores":a=`Lo-res ${t.loRes?"ON":"OFF"} (pixelRatio = ${t.dPR})`;break;case"fschange":a=(t.isFullscreen?"Enter":"Exit")+"ed fullscreen";break;case"user":a=(Ts()?"Resized for":"Closed")+" PIP";break;default:return}Xs(`${a||e}. Canvas size is ${t.canvas.width} x ${t.canvas.height} px`)}});const j=Ln.audioCtx;j.createStereoPanner&&(Pn=j.createStereoPanner(),Ln.connectInput(Pn)),En=0,An=1;for(const n of[0,1])Zn[n]=At(`#player${n}`),Ys(n),Zn[n].addEventListener("play",a),Zn[n].addEventListener("ended",e),Zn[n].addEventListener("error",t),Zn[n].addEventListener("timeupdate",c),Zn[n].querySelector("track").addEventListener("load",Xo),Pn?j.createMediaElementSource(Zn[n]).connect(Pn):Ln.connectInput(Zn[n]);Hs(Ga,0,1,.001),Ga.value=0,Wa.innerText=za.innerText=qs(0,!0),function(){const e=(e,t,a,n,s)=>{a.forEach((a=>{e.innerHTML+=`<label><input type="checkbox" class="${t}" data-option="${a.value}" ${a.disabled?"":"checked"}> ${a.text}</label>`})),Pt(`.${t}`).forEach((e=>{e.addEventListener("click",(t=>{if(!e.checked&&a.filter((e=>!e.disabled)).length<2)return F().alert({text:"At least one item must be enabled!"}),t.preventDefault(),!1;const o=a.find((t=>t.value==e.dataset.option));o&&(o.disabled=!e.checked,So(n,a),Io(s))}))}))},t=e=>+e.value>=+e.min&&+e.value<=+e.max;e(At("#enabled_modes"),"enabledMode",cn,ha,Te),e(At("#enabled_bgfit"),"enabledBgFit",pn,qt,Se);const a=At("#enabled_gradients");Object.keys(rn).forEach((e=>{a.innerHTML+=`<label><input type="checkbox" class="enabledGradient" data-grad="${e}" ${rn[e].disabled?"":"checked"}> ${rn[e].name}</label>`})),xo();const n=At("#random_properties");un.forEach((e=>{n.innerHTML+=`<label><input type="checkbox" class="randomProperty" value="${e.value}" ${e.disabled?"":"checked"}> ${e.text}</label>`})),Pt(".randomProperty").forEach((e=>{e.addEventListener("click",(t=>{un.find((t=>t.value==e.value)).disabled=!e.checked,Io($e)}))})),Pt("[data-preset]").forEach((e=>{"reset-sens"==e.className?e.addEventListener("click",(()=>{const t=e.dataset.preset;At(`.min-db[data-preset="${t}"]`).value=fn[t].min,At(`.max-db[data-preset="${t}"]`).value=fn[t].max,At(`.linear-boost[data-preset="${t}"]`).value=fn[t].boost,Pt(`[data-preset="${t}"]`).forEach((e=>{e.classList.remove("field-error")})),e.dataset.preset==ms(Fa)&&Go(Fa,!1),Io(Fe)})):e.addEventListener("change",(()=>{t(e)&&(e.dataset.preset==ms(Fa)&&Go(Fa,!1),Io(Fe)),e.classList.toggle("field-error",!t(e))}))}));for(const e of[aa,tn,Gt,qa,Ba])e.addEventListener("change",(()=>Io(Ce)));At("#reset_osd").addEventListener("click",(()=>{jo(hn),Io(Ce)})),mn.forEach((e=>{e.addEventListener("change",(()=>{const a="number"!=e.type||t(e);a&&Go(e),e.classList.toggle("field-error",!a)}))})),At("#reset_general").addEventListener("click",(()=>{No(bn),Go(mn)})),kn.forEach((e=>{e.addEventListener("change",(()=>{const a="number"!=e.type||t(e);a&&Go(e),e.classList.toggle("field-error",!a)}))})),At("#reset_peak").addEventListener("click",(()=>{Wo(yn),Go(kn)})),wn.forEach((e=>e.addEventListener("change",(()=>Go(e))))),At("#reset_subs").addEventListener("click",(()=>{Vo(xn),Go(wn)})),Go(wn)}(),So(ha,cn);for(const e of[16,20,25,30,40,50,60,100,250,500,1e3,2e3])Aa[Aa.options.length]=new Option((e>=1e3?e/1e3+"k":e)+"Hz",e);for(const e of[1e3,2e3,4e3,8e3,12e3,16e3,2e4,22e3])Ca[Ca.options.length]=new Option(e/1e3+"kHz",e);wo(jt,dn),wo(Fa,[["0","Low"],["1","Normal"],["2","High"]]),wo(Ft,[["1.5","Min"],["0.1","10"],["0.25","25"],["0.5","50"],["0.75","75"]]),So($a,[["0","OFF"],["1","On track change"],["2","5 seconds"],["6","15 seconds"],["12","30 seconds"],["24","1 minute"],["48","2 minutes"],["120","5 minutes"]]),wo(Pa,[["0","Off"],["1","On"],["2","Full"]]),So(qt,pn),wo(fa,[["-1","Left"],["0","Off"],["1","Right"]]),wo(Jt,[[pt,"Bark"],["linear","Lin"],[mt,"Log"],["mel","Mel"]]),wo(on,[["","OFF"],["A","A"],["B","B"],["C","C"],[$t,"D"],["468","468"]]),wo(Ut,[[fe,"Gradient"],[he,"Index"],[pe,"Level"]]),Hs(Bt,.1,1,.1),Hs(oa,1,3,.5),Hs(Vt,0,.5,.1),Hs(Ya,0,3,1),qo(),Object.keys(rn).forEach((e=>{const{bgColor:t,dir:a,colorStops:n}=rn[e];n&&Ln.registerGradient(e,{bgColor:t,dir:a,colorStops:n})})),Lo();const W=function(e,t={}){let a;var n;return m=document.createElement("ul"),m.className="breadcrumb",e.append(m),b=document.createElement("ul"),b.className="filelist",e.append(b),a=setTimeout((()=>{m.innerHTML="Waiting for server..."}),5e3),m.innerHTML="Initializing... please wait...",m.addEventListener("click",(async function(e){e.target&&"LI"==e.target.nodeName&&function(e){let t;for(;e>0;)t=v.pop(),e--;const a=v[v.length-1];a&&a.handle&&(f=a.handle,t=null),E(t,t&&t.scrollTop)}(e.target.dataset.depth)})),b.addEventListener("click",(async function(e){const t=e.target;if(t&&"LI"==t.nodeName)if("dir"==t.dataset.type)E(t.handle||t.dataset.path);else if("mount"==t.dataset.type)if(L)try{f=await window.showDirectoryPicker({startIn:"music"}),v=[],E(f)}catch(e){}else v=[],E(t.dataset.path)})),b.addEventListener("dblclick",(function(e){const t=e.target;t&&"LI"==t.nodeName&&h&&["file","list"].includes(t.dataset.type)&&h({file:$(t.dataset.path),handle:t.handle,subs:t.subs},e)})),"function"==typeof t.onDblClick&&(h=t.onDblClick),"function"==typeof t.onEnterDir&&(p=t.onEnterDir),t.fileExtensions&&(n=t.fileExtensions,k=new RegExp("\\.("+n.join("|")+")$","i")),new Promise((e=>{fetch("/serverInfo").then((e=>e.text())).then((async n=>{if(clearTimeout(a),n.startsWith("audioMotion")?(w=!0,g=1):g=u,1==g&&o){const e=await fetch("/getMounts");y=await e.json(),O(await async function(){const e=await fetch("/getHomeDir"),t=await e.text();let a=[];for(const e of t.split(i?"\\":"/"))a.push({dir:e,scrollTop:0});return a}())}else y=[t.rootPath||s],x=await E(y[0]),(t.forceFileSystemAPI&&l||!x)&&(v=[],l?(y=[r],L=!0):y=[],S());e({serverMode:g,useFileSystemAPI:L,hasServerMedia:x,filelist:b,serverSignature:g==u?"Standard web server":n})})).catch((t=>{clearTimeout(a),g=-1,l?(y=[r],L=!0):y=[],S(),e({serverMode:g,useFileSystemAPI:L,filelist:b})}))}))}(At("#file_explorer"),{onDblClick:(e,t)=>{Ns([e],!0),t.target.classList.remove("selected","sortable-chosen")},onEnterDir:e=>{Ia.checked&&d&&Bs(e)},fileExtensions:[...be,...ve,...ke],forceFileSystemAPI:H}).then((e=>{Mn=e.serverMode,$n=e.hasServerMedia,Dn=e.useFileSystemAPI;const{filelist:t,serverSignature:a}=e;Mn!=gt&&Xs(`${a} detected at ${U}`),$n||Xs(Mn==gt?"No server found":"Cannot access music directory on server",!0),Dn&&Xs("Accessing files from local device via File System Access API."),!Rn&&P.enableLocalAccess&&Xs("No browser support for File System Access API. Cannot access files from local device.",H),B||(Mo(Ae,H&&Rn),fo()),(B||Dn||$n)&&R.Ay.create(t,{animation:150,draggable:'[data-type="file"], [data-type="list"]',group:{name:"filelist",pull:"clone",put:!1},multiDrag:!0,multiDragKey:"ctrl",selectedClass:"selected",sort:!1,onEnd:e=>{if("playlist"==e.to.id){let t=e.items.length?e.items:[e.item],a=[];t.forEach((e=>{a.push(zs({file:$(e.dataset.path),handle:e.handle,subs:e.subs})),e.remove()})),Promise.all(a).then((()=>ai(!0)))}}}),Zo()}));window.addEventListener("keydown",so),window.addEventListener("keyup",so),F().setOptions({positions:{alert:"bottom"}}),Promise.all([Co(),W]).then((async()=>{const e=()=>{a&&O(a),Ma.checked&&co({file:!0})},t=async()=>{!(s&&"granted"!=await n.requestPermission()||o&&"granted"!=await a[0].handle.requestPermission())&&(ua.classList.remove("locked"),window.removeEventListener("click",t),s&&Co(),e())},a=await(Dn?(0,M.Jt)(Oe):lo(Oe)),n=await(0,M.Jt)(we),s=Rn&&n&&"granted"!=await n.queryPermission(),o=Dn&&Array.isArray(a)&&a[0]&&"granted"!=await a[0].handle.queryPermission();Xs(`Loading ${N?"last session":"default"} settings`),uo("last",!1,!0),s||o?(ua.classList.add("locked"),window.addEventListener("click",t)):e(),Xs(`AudioContext sample rate is ${j.sampleRate}Hz; Total latency is ${1e3*((j.outputLatency||0)+j.baseLatency)|0}ms`),Xs("Initialization complete!"),d=!0}))}()},6216:()=>{Element.prototype.scrollIntoViewIfNeeded||(Element.prototype.scrollIntoViewIfNeeded=function(e){e=0===arguments.length||!!e;var t=this.parentNode,a=window.getComputedStyle(t,null),n=parseInt(a.getPropertyValue("border-top-width")),s=parseInt(a.getPropertyValue("border-left-width")),o=this.offsetTop-t.offsetTop<t.scrollTop,i=this.offsetTop-t.offsetTop+this.clientHeight-n>t.scrollTop+t.clientHeight,l=this.offsetLeft-t.offsetLeft<t.scrollLeft,r=this.offsetLeft-t.offsetLeft+this.clientWidth-s>t.scrollLeft+t.clientWidth,c=o&&!i;(o||i)&&e&&(t.scrollTop=this.offsetTop-t.offsetTop-t.clientHeight/2-n+this.clientHeight/2),(l||r)&&e&&(t.scrollLeft=this.offsetLeft-t.offsetLeft-t.clientWidth/2-s+this.clientWidth/2),(o||i||l||r)&&!e&&this.scrollIntoView(c)})},143:()=>{},3411:()=>{}},a={};function n(e){var s=a[e];if(void 0!==s)return s.exports;var o=a[e]={exports:{}};return t[e].call(o.exports,o,o.exports,n),o.exports}n.m=t,e=[],n.O=(t,a,s,o)=>{if(!a){var i=1/0;for(d=0;d<e.length;d++){for(var[a,s,o]=e[d],l=!0,r=0;r<a.length;r++)(!1&o||i>=o)&&Object.keys(n.O).every((e=>n.O[e](a[r])))?a.splice(r--,1):(l=!1,o<i&&(i=o));if(l){e.splice(d--,1);var c=s();void 0!==c&&(t=c)}}return t}o=o||0;for(var d=e.length;d>0&&e[d-1][2]>o;d--)e[d]=e[d-1];e[d]=[a,s,o]},n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={792:0};n.O.j=t=>0===e[t];var t=(t,a)=>{var s,o,[i,l,r]=a,c=0;if(i.some((t=>0!==e[t]))){for(s in l)n.o(l,s)&&(n.m[s]=l[s]);if(r)var d=r(n)}for(t&&t(a);c<i.length;c++)o=i[c],n.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return n.O(d)},a=self.webpackChunkaudioMotion=self.webpackChunkaudioMotion||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})();var s=n.O(void 0,[96],(()=>n(6965)));s=n.O(s)})();